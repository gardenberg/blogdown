---
title: Hvor populære blir navnene?
author: Eivind
date: '2020-10-09'
slug: hvor-populære-blir-navnene
categories:
  - statistikk
tags:
  - R
---

```{r, include = FALSE}
library(tidyverse)
library(here)
library(prophet)

#settings
gammel = theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
```

# Data

```{r}
#laster inn data på alle jentenavn på fødte fra 1880 til 2019
#kilde: https://www.ssb.no/statbank/table/10467/tableViewLayout1/

#data
df <- read_delim(here("content/data/navnestatistikk/PersonerProsent.csv"), ";", escape_double = FALSE, 
                 locale = locale(decimal_mark = ",", grouping_mark = "|", encoding = "ISO-8859-1"),
                 trim_ws = TRUE, skip = 1, na = c(".", "..")) %>%
  select(fornavn, år, andel = `Andel av fødte (prosent)`) %>%
  mutate(., andel = parse_number(andel))


```

```{r}
#burde ha en sjekk av at alle årene er med her.
```

En anna begrensning med dette, er at det er navn til de som er født i Norge - ikke navn til alle som bor i Norge. 

Hva er det som ligger her? Vi ser nærmere på trednene til ti tilfeldig utvalgte navn.

```{r}
utvalg_av_navn = slice_sample(df, fornavn, n = 10)
temp = filter(df, fornavn %in% utvalg_av_navn$fornavn)

ggplot(data = temp, aes(x = år, y = andel)) +
  geom_line() +
  facet_wrap(vars(fornavn))

```

# Aurora og Vilde

```{r}
#hvor populær er Aurora?
ggplot(data = filter(df, fornavn == "Aurora"|fornavn == "Vilde")) +
  geom_line(aes(x = år, y = andel, colour = fornavn))

```

# Prediksjon av trend


```{r}
#prediksjon med prophet
#https://facebook.github.io/prophet/docs/quick_start.html#r-api

#påkrevd dataformat
df_prophet = filter(df, fornavn == "Aurora") %>%
  select(ds = år, y = andel) %>%
  mutate(
    ds = as.character(ds),
    ds = as.Date(ds, format = "%Y"))

#modell
modell = prophet(df_prophet)

framtida = make_future_dataframe(modell, periods = 80, freq = "year")
df_prediksjon = predict(modell, framtida)

#graf
plot(modell, df_prediksjon)

```

Dette er en enkel tidsserie. Men det er jo ikke urimelig å forvente at navnetrender er nokenlunde like. Dvs. at en kan lære om trenden til et navn, ved å se på andre.