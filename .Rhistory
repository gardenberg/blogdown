names(df) = c("knr_2018","value")
#pakker
suppressPackageStartupMessages(library(tidyverse))
library(PxWebApiData)
library(here)
library(ggridges)
#valg - et kjekt standard-tema for ggplot2
theme_set(theme_minimal())
#SFO
sfo_data = ApiData("https://data.ssb.no/api/v0/no/table/11975",
KOKkommuneregion0000 = TRUE,
ContentsCode = "KOSandsfo69kp0000",
Tid = "2018"
)
df = sfo_data[[2]] %>%
select(., -ContentsCode, -Tid) %>% #fjerner variabler med kun 1 verdi (konstanter)
filter(., nchar(KOKkommuneregion0000) == 4) %>% #filtrer ut alle regioner som ikke har 4 karakterer
names(df) = c("knr_2018","value")
#SFO
sfo_data = ApiData("https://data.ssb.no/api/v0/no/table/11975",
KOKkommuneregion0000 = TRUE,
ContentsCode = "KOSandsfo69kp0000",
Tid = "2018"
)
df = sfo_data[[2]] %>%
select(., -ContentsCode, -Tid) %>% #fjerner variabler med kun 1 verdi (konstanter)
filter(., nchar(KOKkommuneregion0000) == 4) #filtrer ut alle regioner som ikke har 4 karakterer
names(df) = c("knr_2018","value")
#sentralitet
sentralitet = read.csv2(here("content/data/sentralitet_2018.csv"), stringsAsFactors = FALSE, colClasses = c("character", "integer", "integer"))
sentralitet$sklasse_2018 = factor(sentralitet$sklasse_2018, labels = c("Mest sentral", "2", "3", "4", "5", "Minst sentral"))
df = left_join(df, sentralitet) %>%
filter(., is.na(value) == FALSE, is.na(sklasse_2018) == FALSE)
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "De mest sentrale kommunene har høyere deltakelse i SFO")
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "Flest bybarn bruker SFO")
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "Flest bybarn bruker SFO") +
annotate("text", x = 7, y = 50, label = "3. kvartil")
?scale_x_discrete
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "Flest bybarn bruker SFO") +
scale_x_discrete(limits = c(0,7)) +
annotate("text", x = 7, y = 50, label = "3. kvartil")
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "Flest bybarn bruker SFO") +
annotate("text", x = 7, y = 50, label = "3. kvartil")
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "Flest bybarn bruker SFO") +
annotate("text", x = 6.5, y = 50, label = "3. kvartil")
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "Flest bybarn bruker SFO") +
annotate("text", x = 1.5, y = 50, label = "3. kvartil")
ggplot(data = df, aes(x = sklasse_2018, y = value)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
labs(x = "Sentralitet", y = "Andel barn i SFO", title = "Flest bybarn bruker SFO") +
annotate("text", x = 1.5, y = 80, label = "3. kvartil") +
annotate("text", x = 1.5, y = 70, label = "Median") +
annotate("text", x = 1.5, y = 65, label = "1. kvartil")
blogdown:::insert_image_addin()
blogdown:::serve_site()
library(here)
library(tidyverse)
theme_set(theme_minimal())
#sett inn figuren fra disse dataene
#https://trends.google.com/trends/explore?date=all&geo=NO&q=data%20science,Kunstig%20intelligens
df = read.csv(here("content","data","google_searches_ds_ai.csv"), skip = 2, stringsAsFactors = FALSE, fileEncoding = "UTF-8")
names(df) = c("dato", "datascience", "kunstig intelligens")
df = gather(df, searchterm, verdi, datascience:`kunstig intelligens`)
df$dato = as.Date(paste0(df$dato,"-","01"), "%Y-%m-%d") #aner ikke hvorfor jeg må legge til en dag, men det fungerer
qplot(data = df, x = dato, y = verdi, colour = searchterm, group = searchterm, geom = "line")+
labs(colour = "søkeord", title ="Google-søk etter datavitenskap og AI følger hverandre tett")
# henter data fra https://data.nav.no/dataset/utlysningstekster-ledige-stillinger-historikk/resource/882e3e0f-cd3c-4d3a-8072-be7ba7b3d272
df = read.csv2("https://data.nav.no/dataset/408fc52c-b50e-4ee7-a620-305eaa5d56e7/resource/882e3e0f-cd3c-4d3a-8072-be7ba7b3d272/download/stillingstekster-2018.csv", stringsAsFactors = FALSE, header = TRUE, fileEncoding = "UTF-8")
blogdown:::serve_site()
blogdown:::serve_site()
df = read.csv2("https://data.nav.no/dataset/408fc52c-b50e-4ee7-a620-305eaa5d56e7/resource/882e3e0f-cd3c-4d3a-8072-be7ba7b3d272/download/stillingstekster-2018.csv", stringsAsFactors = FALSE, header = TRUE, fileEncoding = "UTF-8")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
library(here)
library(tidyverse)
here("content/data/")
here("content/data/valgprogram")
mappe <- here("content/data/valgprogram")
pdfs <- paste(mappe, "/", list.files(mappe, pattern = "*.pdf"), sep = "")
pdfs
pdf_navn <- list.files(mappe, pattern = "*.pdf")
??map
map
install.packages("pdftools")
pdfs_text <- map(pdfs, pdftools::pdf_text)
View(pdfs_text)
??pdf_text
?readtext
??readtext
library(tm)
mappe <- here("content/data/valgprogram")
install.packages("tm")
?VCorpus
library(tm)
?VCorpus
?DirSource
?readerControl
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix()
converted %>%
tidy() %>%
filter(!grepl("[0-9]+", term))
install.packages("tidytext")
library(tidytext)
converted %>%
tidy() %>%
filter(!grepl("[0-9]+", term))
View(converted)
converted
?tidy
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix()
converted %>%
tidy()
df = tidy(converted)
View(df)
test = filter(df, !grepl("[0-9]+", term))
View(test)
View(df)
df = tidy(converted) %>%
filter(., !grepl("[0-9]+", term))
View(df)
?DocumentTermMatrix
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE
))
df = tidy(converted)
View(df)
?gsub
test = mutate(df, document = gsub(".pdf", "", document, fixed = TRUE))
View(test)
#med TM
mappe <- here("content/data/valgprogram")
# lag et korpus fra pdf-filene
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE
))
#fjerner .pdf-suffixet
df = tidy(converted) %>%
mutate(df, document = gsub(".pdf", "", document, fixed = TRUE))
df = tidy(converted) %>%
mutate(., document = gsub(".pdf", "", document, fixed = TRUE))
names(df) = c("parti", "term", "antall")
temp = group_by(df, parti) %>%
summarise(., antall_termer = n())
View(temp)
ggplot(data = temp, aes(x = parti, y = antall_termer)) +
geom_col()
ggplot(data = temp, aes(x = parti, y = antall_termer)) +
geom_col() +
coord_flip()
theme_set(theme_minimal())
?fct_reorder
ggplot(data = temp, aes(x = fct_reorder(parti, antall_termer), y = antall_termer)) +
geom_col() +
coord_flip()
ggplot(data = temp, aes(x = fct_reorder(parti, antall_termer), y = antall_termer)) +
geom_col() +
coord_flip() +
labs(title = "Rødt har flest unike termer i partiprogrammet", subtitle = "Partienes valgprogram for Oslo, 2019-2023", x = "Antall termer", y = "Parti")
ggplot(data = temp, aes(x = fct_reorder(parti, antall_termer), y = antall_termer)) +
geom_col() +
coord_flip() +
labs(title = "Rødt har flest unike termer i partiprogrammet", subtitle = "Partienes valgprogram for Oslo, 2019-2023", y = "Antall termer",x = "Parti")
?stop_words
?stopwords
stoppord = stopwords("nb")
stoppord = stopwords("no")
stoppord = stopwords("no")
df = anti_join(df, stoppord)
stoppord = data.frame(stoppord = stopwords("no"))
stoppord = data.frame(stoppord = stopwords("no"), stringsAsFactors = FALSE)
df = anti_join(df, stoppord)
stoppord = data.frame(term = stopwords("no"), stringsAsFactors = FALSE)
df = anti_join(df, stoppord)
View(df)
temp = group_by(df, parti) %>%
summarise(., antall_termer = n())
ggplot(data = temp, aes(x = fct_reorder(parti, antall_termer), y = antall_termer)) +
geom_col() +
coord_flip() +
labs(title = "Rødt har flest unike termer i partiprogrammet", subtitle = "Partienes valgprogram for Oslo, 2019-2023", y = "Antall termer",x = "Parti")
temp = group_by(df, parti) %>%
top_n(10)
View(temp)
ggplot(data = temp, aes(x = term, y = antall, fill = parti)) +
geom_col() +
facet_wrap(~book)
ggplot(data = temp, aes(x = term, y = antall, fill = parti)) +
geom_col() +
facet_wrap(~parti)
ggplot(data = temp, aes(x = term, y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti)
ggplot(data = temp, aes(x = term, y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, ncol = 2) +
coord_flip()
ggplot(data = temp, aes(x = term, y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, ncol = 2, scales = "free") +
coord_flip()
ggplot(data = temp, aes(x = term, y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
coord_flip()
ggplot(data = temp, aes(x = fct_reorder(term, antall), y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
coord_flip()
?fct_reorder
temp = group_by(df, parti) %>%
top_n(10) %>%
arrange(., antall)
ggplot(data = temp, aes(x = fct_reorder(term, antall), y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
coord_flip()
ggplot(data = temp, aes(x = term, y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
coord_flip()
ggplot(data = temp, aes(x = fct_reorder(term, antall), y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
coord_flip()
?reorder_within
ggplot(data = temp, aes(x = reorder_within(term, antall, parti), y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
coord_flip()
ggplot(data = temp, aes(x = reorder_within(term, antall, parti), y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
scale_x_reordered() +
coord_flip()
?bind_tf_idf
program_ord = bind_tf_idf(df, term, parti, antall)
View(program_ord)
?top_n
temp = group_by(df, parti) %>%
top_n(10, wt = antall) %>%
arrange(., antall)
ggplot(data = temp, aes(x = reorder_within(term, antall, parti), y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
scale_x_reordered() +
coord_flip() +
labs(title = "Oslo og eget parti langt det mest vanlige å omtale", subtitle = "Ti mest brukte ord i  valgprogrammet for 2019-2023", x = "Parti", y = "Antall ganger ordet er nevnt")
temp = group_by(program_ord, parti) %>%
top_n(10, wt = tf_idf)
ggplot(data = temp, aes(x = reorder_within(term, tf_idf, parti), y = tf_idf, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
scale_x_reordered() +
coord_flip() +
labs(title = "Oslo og eget parti langt det mest vanlige å omtale", subtitle = "Ti mest brukte ord i  valgprogrammet for 2019-2023", x = "Parti", y = "Antall ganger ordet er nevnt")
program_ord = bind_tf_idf(df, term, parti, antall)
temp = group_by(program_ord, parti) %>%
top_n(10, wt = tf_idf)
ggplot(data = temp, aes(x = reorder_within(term, tf_idf, parti), y = tf_idf, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free") +
scale_x_reordered() +
coord_flip()
temp = summarise(df, antall_termer = n())
temp = summarise(df, antall_termer = n(term))
temp = group_by(df, term) %>%
summarise(., antall = n())
temp = group_by(df, term) %>%
summarise(., antall = n()) %>%
top_n(., 10, antall)
View(temp)
temp = group_by(df, term) %>%
summarise(., antall = sum()) %>%
top_n(., 10, antall)
View(temp)
emp = group_by(df, term) %>%
summarise(., antall = sum())
temp = group_by(df, term) %>%
summarise(., antall = count()) %>%
top_n(., 10, antall)
temp = group_by(df, term) %>%
summarise(., antall = sum(antall))
temp = group_by(df, term) %>%
summarise(., antall = sum(antall)) %>%
top_n(., 10, antall)
ggplot(data = temp, aes(x = fct_reorder(term, antall), y = antall)) +
geom_col() +
coord_flip() +
labs(title = "Rødt har flest unike termer i partiprogrammet", subtitle = "Partienes valgprogram for Oslo, 2019-2023", y = "Antall termer",x = "Parti")
ggplot(data = temp, aes(x = fct_reorder(term, antall), y = antall)) +
geom_col() +
coord_flip() +
labs(title = "Oslo det mest brukte ordet i Oslo-valgkampen", y = "Antall ganger brukt",x = "Ord")
temp = group_by(df, parti) %>%
top_n(10, wt = antall) %>%
arrange(., antall)
ggplot(data = temp, aes(x = reorder_within(term, antall, parti), y = antall, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free", ncol = 2) +
scale_x_reordered() +
coord_flip() +
labs(title = "Oslo og eget parti langt det mest vanlige å omtale", subtitle = "Ti mest brukte ord i  valgprogrammet for 2019-2023", x = "Parti", y = "Antall ganger ordet er nevnt")
program_ord = bind_tf_idf(df, term, parti, antall)
temp = group_by(program_ord, parti) %>%
top_n(10, wt = tf_idf)
ggplot(data = temp, aes(x = reorder_within(term, tf_idf, parti), y = tf_idf, fill = parti)) +
geom_col(show.legend = FALSE) +
facet_wrap(~parti, scales = "free", ncol = 2) +
scale_x_reordered() +
coord_flip() +
labs(title = )
#litt enkel grafing
temp = group_by(df, parti) %>%
summarise(., antall_termer = n())
ggplot(data = temp, aes(x = fct_reorder(parti, antall_termer), y = antall_termer)) +
geom_col() +
coord_flip() +
labs(title = "Rødt har flest unike termer i partiprogrammet", subtitle = "Partienes valgprogram for Oslo, 2019-2023", y = "Antall termer",x = "Parti")
temp = group_by(df, term) %>%
summarise(., antall = sum(antall)) %>%
top_n(., 10, antall)
ggplot(data = temp, aes(x = fct_reorder(term, antall), y = antall)) +
geom_col() +
coord_flip() +
labs(title = "Oslo det mest brukte ordet i Oslo-valgkampen", y = "Antall ganger brukt",x = "Ord")
blogdown:::serve_site()
blogdown:::new_post_addin()
library(topicmodels)
install.packages("topicmodels")
library(topicmodels)
suppressPackageStartupMessages(library(tidyverse))
library(tidytext)
library(here)
library(tm)
library(topicmodels)
#settings
theme_set(theme_minimal())
#med TM
mappe <- here("content/data/valgprogram")
# lag et korpus fra pdf-filene
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE
))
#opprydding
#fjerner .pdf-suffixet
df = tidy(converted) %>%
mutate(., document = gsub(".pdf", "", document, fixed = TRUE))
#setter bedre navn på variablene
names(df) = c("parti", "term", "antall")
#fjerner stoppord - ganske lite sofistikert
stoppord = data.frame(term = stopwords("no"), stringsAsFactors = FALSE)
df = anti_join(df, stoppord)
#med TM
mappe <- here("content/data/valgprogram")
# lag et korpus fra pdf-filene
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE
))
#opprydding
#fjerner .pdf-suffixet
df = tidy(converted) %>%
mutate(., document = gsub(".pdf", "", document, fixed = TRUE))
#setter bedre navn på variablene
names(df) = c("parti", "term", "antall")
#fjerner stoppord - ganske lite sofistikert
stoppord = data.frame(term = stopwords("no"), stringsAsFactors = FALSE)
df = anti_join(df, stoppord)
set.seed(1106)
model_1 = LDA(converted, k = 2)
tema = tidy(model_1, matrix = "beta")
tema
tema_topp = group_by(tema, topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
View(tema_topp)
tema_topp = group_by(tema, topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(term = reorder_within(term, beta, topic))
tema_topp = group_by(tema, topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill(factor(topic)))) +
geom_col(show.legend = FALSE) +
coord_flip() +
scale_x_reordered()
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill(factor(topic)))) +
geom_col(show.legend = FALSE) +
coord_flip() +
facet_wrap(~topic) +
scale_x_reordered()
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill(factor(topic)))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
coord_flip() +
scale_x_reordered()
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
coord_flip() +
scale_x_reordered()
?DocumentTermMatrix
stoppord = data.frame(term = stopwords("no"), stringsAsFactors = FALSE)
stoppord[1]
stopwords("no")
stoppord = stopwords("no")
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE,
stopwords = stopwords("no") #fjerner stoppord
))
model_1 = LDA(converted, k = 2)
tema = tidy(model_1, matrix = "beta")
tema
tema_topp = group_by(tema, topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
coord_flip() +
scale_x_reordered()
model_1 = LDA(converted, k = 5)
tema = tidy(model_1, matrix = "beta")
tema
tema_topp = group_by(tema, topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
coord_flip() +
scale_x_reordered()
model_1 = LDA(converted, k = 7)
tema = tidy(model_1, matrix = "beta")
tema
tema_topp = group_by(tema, topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
coord_flip() +
scale_x_reordered()
model_1 = LDA(converted, k = 9)
tema = tidy(model_1, matrix = "beta")
tema_topp = group_by(tema, topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
ggplot(data = tema_topp, aes(reorder_within(term, beta, topic) , beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
coord_flip() +
scale_x_reordered()
tema_dokument = tidy(model_1, matrix = "gamma")
ggplot(data = tema_dokument, aes(factor(topic), gamma)) +
geom_boxplot() +
facet_wrap(~ reorder(title, gamma * topic))
ggplot(data = tema_dokument, aes(factor(topic), gamma)) +
geom_boxplot()
ggplot(data = tema_dokument, aes(factor(topic), gamma)) +
geom_boxplot() +
facet_wrap(~reorder(title, gamma * topic)
ggplot(data = tema_dokument, aes(factor(topic), gamma)) +
ggplot(data = tema_dokument, aes(factor(topic), gamma)) +
geom_boxplot() +
facet_wrap(~title)
ggplot(data = tema_dokument, aes(factor(topic), gamma)) +
geom_boxplot() +
facet_wrap(~document)
blogdown:::serve_site()
