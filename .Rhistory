if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= 11){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > 11){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
df_alle = group_by(df_alle, periode) %>%
mutate(dag_periode = seq_along(dato))
View(df_alle)
View(df_alle)
df_survival = select(df_alle, dato, dager_siden_trening, økt_id)
df_survival = ungroup(df_alle) %>%
select(df_alle, dato, dager_siden_trening, økt_id)
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id)
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id) %>%
group_by(økt_id) %>%
filter(max(dager_siden_trening))
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id) %>%
group_by(økt_id) %>%
filter(dager_siden_trening == max(dager_siden_trening))
View(df_survival)
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id, er_trening) %>%
group_by(økt_id) %>%
filter(dager_siden_trening == max(dager_siden_trening))
library(survival)
?survfit
?Surv
!df_survival$er_trening
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id, er_trening) %>%
group_by(økt_id) %>%
filter(dager_siden_trening == max(dager_siden_trening)) %>%
mutate(
pauselengde = dager_siden_trening + 1,
hendelse = !er_trening
)
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id, er_trening) %>%
group_by(økt_id) %>%
filter(dager_siden_trening == max(dager_siden_trening)) %>%
mutate(
pauselengde = dager_siden_trening + 1,
hendelse = !er_trening,
dato = dato + 1
)
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id, er_trening) %>%
group_by(økt_id) %>%
filter(dager_siden_trening == max(dager_siden_trening)) %>%
mutate(
pauselengde = dager_siden_trening,
hendelse = !er_trening,
dato = dato + 1
)
df_survival = ungroup(df_alle) %>%
select(dato, dager_siden_trening, økt_id, er_trening) %>%
group_by(økt_id) %>%
filter(dager_siden_trening == max(dager_siden_trening)) %>%
mutate(
pauselengde = dager_siden_trening,
hendelse = !er_trening
)
trening_survival = Surv(df_survival$pauselengde, df_survival$hendelse==TRUE)
str(trening_survival)
trening_survival = survfit(Surv(pauselengde, hendelse == TRUE)~1, data = df_survival)
trening_survival
ggplot(data = broom::tidy(trening_survival), aes(x = time, y = estimate))+
geom_line() +
geom_ribbon(aes(ymin=conf.low,ymax=conf.high),alpha=0.2)+
ggtitle("Kaplan-Meier survival curve")
trening_survival
temp = broom::tidy(trening_survival)
ggplot(data = temp, aes(x = time, y = estimate))+
geom_line() +
geom_ribbon(aes(ymin=conf.low,ymax=conf.high),alpha=0.2)+
ggtitle("Kaplan-Meier survival curve")
View(temp)
temp = broom::tidy(trening_survival) %>%
filter(time < 50)
ggplot(data = temp, aes(x = time, y = estimate))+
geom_line() +
geom_ribbon(aes(ymin=conf.low,ymax=conf.high),alpha=0.2)+
ggtitle("Kaplan-Meier survival curve")
ggplot(data = temp, aes(x = time, y = estimate))+
geom_line() +
geom_ribbon(aes(ymin=conf.low,ymax=conf.high),alpha=0.2) +
labs(x = "Dagers pause", y = "Sannsynlighet for å fortsette treningspausa", title = "Sannsynlighet for å fortsette treningspause, etter antall dager", subtitle = "Kaplan-Meier-kurve")
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= 11){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > 11){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
df_alle = group_by(df_alle, periode) %>%
mutate(dag_periode = seq_along(dato))
temp = data.frame(pauselengde = 1:40, antall_perioder = as.numeric())
temp = data.frame(pauselengde = 1:40, antall_perioder = NA)
a = 4
temp[a,]
temp[a,]
temp[a,2]
max(df_alle$periode)
for(a in 1:max(temp$pauselengde)){
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a,2] = max(df_alle$periode)
}
View(temp)
temp = data.frame(pauselengde = 1:40, antall_perioder = NA)
for(a in 1:max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a,2] = max(df_alle$periode)
}
View(temp)
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde:max(temp$pauselengde)){
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a,2] = max(df_alle$periode)
}
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a,2] = max(df_alle$periode)
}
min(temp$pauselengde)
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
min(temp$pauselengde)
max(temp$pauselengde
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a,2] = max(df_alle$periode)
}
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
filter(temp, pauselengde == a)
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
filter(temp, pauselengde == a)$antall_perioder = max(df_alle$periode)
}
filter(temp, pauselengde == a)$antall_perioder
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
filter(temp, pauselengde == a)$antall_perioder = max(df_alle$periode)
}
temp[a - (min(temp$pauselengde)-1),2]
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a - (min(temp$pauselengde)-1),2] = max(df_alle$periode)
}
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 1:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a - (min(temp$pauselengde)-1),2] = max(df_alle$periode)
}
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a - (min(temp$pauselengde)-1),2] = max(df_alle$periode)
}
ggplot(data = temp) +
geom_line(aes(x = pauselengde, y = antall_perioder))
ggplot(data = temp) +
geom_line(aes(x = pauselengde, y = antall_perioder)) +
labs(title = "Antall treningsperioder", x = "Dagers pause for ny periode", y = "Antall perioder")
#settings for loopen i pauselengder
temp = data.frame(pauselengde = 4:28, antall_perioder = NA)
for(a in min(temp$pauselengde):max(temp$pauselengde)){
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= a-1){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > a-1){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
temp[a - (min(temp$pauselengde)-1),2] = max(df_alle$periode)
}
ggplot(data = temp) +
geom_line(aes(x = pauselengde, y = antall_perioder)) +
labs(title = "Antall treningsperioder", x = "Dagers pause for ny periode", y = "Antall perioder")
#settings for treningsloopen
i = 1
df_alle$periode[[1]] = 1
periode = 1
for(i in 2:length(df_alle$dato)){
if(df_alle$er_trening[[i]] == TRUE){
if(df_alle$dager_siden_trening[[i-1]] <= 11){
df_alle$periode[[i]] = periode
}
if(df_alle$dager_siden_trening[[i-1]] > 11){
periode = periode + 1
df_alle$periode[[i]] = periode
}
}
if(df_alle$er_trening[[i]] == FALSE){
df_alle$periode[[i]] = periode
}
}
df_survival = ungroup(df_alle) %>%
select(dato, periode, dag_periode, er_trening) %>%
group_by(periode) %>%
filter(dag_periode == max(dag_periode)) %>%
mutate(
pauselengde = dager_siden_trening,
hendelse = !er_trening
)
#lager en dataframe med den nødvendige informasjonen
df_survival = ungroup(df_alle) %>%
select(dato, periode, dag_periode, er_trening) %>%
group_by(periode) %>%
filter(dag_periode == max(dag_periode)) %>%
mutate(
hendelse = !er_trening
)
ggplot(data = df_survival) +
geom_point(aes(x = dag_periode, y = periode))
ggplot(data = df_survival) +
geom_point(aes(x = dag_periode, y = fct_reorder(periode, dag_periode)))
ggplot(data = df_survival) +
geom_point(aes(x = dag_periode, y = fct_reorder(as.factor(periode), dag_periode)))
ggplot(data = df_survival) +
geom_point(aes(x = dag_periode, y = fct_reorder(as.factor(periode), dag_periode))) +
labs(x = "Varighet på treningsperiode", y = "periode_id", title = "Lengde på periode")
trening_survival = survfit(Surv(dag_periode, hendelse == TRUE)~1, data = df_survival)
trening_survival
ggplot(data = df_survival) +
geom_point(aes(x = dag_periode, y = fct_reorder(as.factor(dato), dag_periode))) +
labs(x = "Varighet på treningsperiode", y = "periode_id", title = "Lengde på periode")
ggplot(data = df_survival) +
geom_point(aes(x = dag_periode, y = fct_reorder(as.factor(dato), dag_periode))) +
labs(x = "Varighet på treningsperiode", y = "periode_id", title = "Lengde på periode") +
scale_x_continuous(limits = c(0, 300))
trening_survival = survfit(Surv(dag_periode, hendelse == TRUE)~1, data = df_survival)
trening_survival
temp = broom::tidy(trening_survival)
View(temp)
ggplot(data = temp, aes(x = time, y = estimate))+
geom_line() +
geom_ribbon(aes(ymin=conf.low,ymax=conf.high),alpha=0.2)
ggplot(data = temp, aes(x = time, y = estimate))+
geom_line() +
geom_ribbon(aes(ymin=conf.low,ymax=conf.high),alpha=0.2) +
labs(x = "Dagers varighet på treningsperiode", y = "Sannsynlighet for å fortsette trening", title = "Sannsynlighet for å fortsette en treningsperiode, etter antall dager", subtitle = "Kaplan-Meier-kurve")
?coxph
View(df_alle)
?Surv
cox_model = coxph(Surv(dag_periode, hendelse == TRUE)~1, data = df_survival)
summary(cox_model)
cox_kurve_0 = survfit(cox_model)
cox_curve_0
cox_kurve_0
View(cox_kurve_0)
plot(cox_curve_0)
plot(cox_kurve_0)
temp = broom::tidy(cox_kurve_0)
View(temp)
ggplot(data = temp, aes(x = time, y = estimate))+
geom_line() +
geom_ribbon(aes(ymin=conf.low,ymax=conf.high),alpha=0.2) +
labs(x = "Dagers varighet på treningsperiode", y = "Sannsynlighet for å fortsette trening", title = "Sannsynlighet for å fortsette en treningsperiode, etter antall dager", subtitle = "Kaplan-Meier-kurve")
?tmerge
temp = tmerge(df_alle, df_alle, id = periode)
View(df_survival)
temp = tmerge(test, df_survival, id = periode)
temp = tmerge(df_survival, df_alle, id = periode)
temp = tmerge(df_survival, df_alle, id = periode, hendelse = event(dato ,hendelse))
temp = tmerge(
data1 = df_survival,
data2 = df_alle,
id = periode,
hendelse = event(dag_periode, hendelse)
)
View(df_alle)
df_alle$hendelse = !df_alle$er_trening
temp = tmerge(
data1 = df_survival,
data2 = df_alle,
id = periode,
hendelse = event(dag_periode, hendelse)
)
View(temp)
View(df_alle)
temp = tmerge(
data1 = select(df_survival, -er_trening),
data2 = df_alle,
id = periode,
hendelse = event(dag_periode, hendelse),
)
temp = tmerge(
data1 = select(df_survival, -er_trening),
data2 = df_alle,
id = periode,
hendelse = event(dag_periode, hendelse)
)
blogdown:::serve_site()
df_alle = group(df_alle, periode)%>%
mutate(dag_periode = seq_along(dato))
df_alle = group_by(df_alle, periode)%>%
mutate(dag_periode = seq_along(dato))
View(df_alle)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
