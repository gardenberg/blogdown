View(sentiment)
sentiment$tekst
sentiment$tekst = gsub(pattern = "[-][012345][\t]|[012345][\t]", replacement = "", x = sentiment$X1)
sentiment$tekst
sentiment$tekst = gsub(pattern = "\t", replacement = "", x = sentiment$Xtekst)
sentiment$tekst_2 = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
sentiment$tekst = gsub(pattern = "[-][012345]|[012345]", replacement = "", x = sentiment$X1)
sentiment$tekst_2 = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
sentiment$tekst_2
sentiment$tekst = gsub(pattern = "[-][012345]|[012345]", replacement = "", x = sentiment$X1)
sentiment$tekst = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
temp = inner_join(sentiment, df, by = c("tekst" = "term"))
View(temp)
sentiment = select(sentiment, -X1)
temp = inner_join(sentiment, df, by = c("tekst" = "term"))
#med TM
mappe <- here("content/data/valgprogram")
# lag et korpus fra pdf-filene
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE,
stopwords = stopwords("no") #fjerner stoppord
))
#opprydding
#fjerner .pdf-suffixet
df_programmer = tidy(converted) %>%
mutate(., document = gsub(".pdf", "", document, fixed = TRUE))
#setter bedre navn på variablene
names(df_programmer) = c("parti", "term", "antall")
#sentiment-data
sentiment <- read_delim(here("content/data/AFINN-no-165.txt"), "|", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
sentiment$verdi = parse_number(sentiment$X1)
sentiment$tekst = gsub(pattern = "[-][012345]|[012345]", replacement = "", x = sentiment$X1)
sentiment$tekst = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
sentiment = select(sentiment, -X1)
df = inner_join(sentiment, df_programmer, by = c("tekst" = "term"))
temp = count(tekst, sort = TRUE)
temp = count(df, tekst, sort = TRUE)
temp
View(df)
?count
temp = count(df, tekst, sort = TRUE, wt = antall)
temp
View(df)
temp = mutate(df, antall_verdi = antall * verdi)
View(temp)
temp = mutate(df, antall_verdi = antall * verdi) %>%
group_by(parti) %>%
summarise(mean = mean(antall_verdi), median = median(antall_verdi))
ggplot(data = temp) +
geom_col(aes(x = parti, y = mean))
ggplot(data = temp) +
geom_col(aes(x = parti, y = mean)) +
coord_flip()
ggplot(data = temp) +
geom_col(aes(x = fct_reorder(parti, mean), y = mean)) +
coord_flip()
?summarise
?mean
temp =  group_by(df, parti) %>%
summarise(mean = weighted.mean(verdi, antall))
ggplot(data = temp) +
geom_col(aes(x = fct_reorder(parti, mean), y = mean)) +
coord_flip()
ggplot(data = temp) +
geom_col(aes(x = fct_reorder(parti, mean), y = mean)) +
coord_flip() +
labs(title = "Høyre og KrF er de mest positive", subtitle = "Rødt og SV de mest negative", x = "Parti", y = "Gjennomsnittlig stemning")
?rep
temp = df[rep(row.names(df), df$antall)]
?uncount
temp = uncount(df, antall)
View(temp)
df_utvida = uncount(df, antall)
temp = count(df, tekst, sort = TRUE, wt = antall)
temp
temp = count(df_utvida, tekst, sort = TRUE)
temp
temp =  group_by(df_utvida, parti) %>%
summarise(mean = mean(verdi))
ggplot(data = temp) +
geom_col(aes(x = fct_reorder(parti, mean), y = mean)) +
coord_flip() +
labs(title = "Høyre og KrF er de mest positive", subtitle = "Rødt og SV de mest negative", x = "Parti", y = "Gjennomsnittlig stemning")
ggplot(data = df_utvida, aes(x = parti, y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0)
ggplot(data = df_utvida, aes(x = parti, y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.3) +
geom_boxplot(alpha = 0) +
coord_flip()
ggplot(data = df_utvida, aes(x = parti, y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip()
ggplot(data = df_utvida, aes(x = fct_reorder(parti, verdi), y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip()
?fct_reorder
ggplot(data = df_utvida, aes(x = fct_reorder(parti, verdi, .fun = median), y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip()
ggplot(data = df_utvida, aes(x = fct_reorder(parti, verdi, .fun = mean), y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip()
library(ggridges)
ggplot(data = df_utvida, aes(x = parti, y = verdi)) +
geom_density_ridges(alpha = 0.7) +
scale_x_continuous(limits = c(0, 100), expand = c(0,0)) +
theme(axis.ticks.y = element_blank())
ggplot(data = df_utvida, aes(x = parti, y = verdi)) +
geom_density_ridges(alpha = 0.7) +
theme(axis.ticks.y = element_blank())
ggplot(data = df_utvida, aes(x = parti, y = verdi)) +
geom_density_ridges(alpha = 0.
ggplot(data = df_utvida, aes(x = parti, y = verdi)) +
geom_density_ridges(alpha = 0.7)
ggplot(data = df_utvida, aes(y = parti, x = verdi)) +
geom_density_ridges(alpha = 0.7) +
theme(axis.ticks.y = element_blank())
ggplot(data = df_utvida, aes(y = parti, x = verdi)) +
geom_density_ridges(alpha = 0.7) +
scale_x_continuous(limits = c(-10, 10), expand = c(0,0)) +
theme(axis.ticks.y = element_blank())
ggplot(data = df_utvida, aes(y = parti, x = verdi)) +
geom_density_ridges(alpha = 0.7) +
scale_x_continuous(limits = c(-5, 5), expand = c(0,0)) +
theme(axis.ticks.y = element_blank())
ggplot(data = df_utvida, aes(y = fct_reorder(parti, verdi, .fun = mean), x = verdi)) +
geom_density_ridges(alpha = 0.7) +
scale_x_continuous(limits = c(-5, 5), expand = c(0,0)) +
theme(axis.ticks.y = element_blank())
?scale_x_continuous
?rep
seq_along()
?seq_along
ggplot(data = df_utvida, aes(y = fct_reorder(parti, verdi, .fun = mean), x = verdi)) +
geom_density_ridges(alpha = 0.7) +
scale_x_continuous(limits = c(-5, 5), breaks = seq(from = -5, to = 5, by = 1), expand = c(0,0)) +
theme(axis.ticks.y = element_blank())
temp = group_by(df_utvida, parti, verdi) %>%
summarise(., antall = count(verdi))
?summarise
temp = group_by(df_utvida, parti, verdi) %>%
summarise(., antall = n(verdi))
temp = group_by(df_utvida, parti, verdi) %>%
summarise(., antall = n())
View(temp)
temp = group_by(df_utvida, parti, verdi) %>%
summarise(., antall = n(), andel = n() / sum(antall))
temp = group_by(df_utvida, parti, verdi) %>%
summarise(., antall = n()) %>%
mutate(., andel = antall / sum(antall))
ggplot(data = temp) +
geom_col(aes(x = verdi, y = andel)) +
facet_wrap(~parti)
blogdown:::serve_site()
suppressPackageStartupMessages(library(tidyverse))
library(tidytext)
library(here)
library(tm)
library(ggridges)
#settings
theme_set(theme_minimal())
set.seed(1106)
#med TM
mappe <- here("content/data/valgprogram")
# lag et korpus fra pdf-filene
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE
))
#opprydding
#fjerner .pdf-suffixet
df_programmer = tidy(converted) %>%
mutate(., document = gsub(".pdf", "", document, fixed = TRUE))
#setter bedre navn på variablene
names(df_programmer) = c("parti", "term", "antall")
#sentiment-data
sentiment <- read_delim(here("content/data/AFINN-no-165.txt"), "|", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
sentiment$verdi = parse_number(sentiment$X1)
sentiment$tekst = gsub(pattern = "[-][012345]|[012345]", replacement = "", x = sentiment$X1)
sentiment$tekst = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
sentiment = select(sentiment, -X1)
?sample_n
temp = group_by(sentiment, verdi) %>%
sample_n(., 5)
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n())
temp
View(sentiment)
sentiment = filter(sentiment, is.na(verdi) == FALSE)
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n())
temp
sentiment = filter(sentiment, is.na(verdi) == FALSE) %>%
filter(., verdi > 5)
sentiment <- read_delim(here("content/data/AFINN-no-165.txt"), "|", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
sentiment$verdi = parse_number(sentiment$X1)
sentiment$tekst = gsub(pattern = "[-][012345]|[012345]", replacement = "", x = sentiment$X1)
sentiment$tekst = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
sentiment = select(sentiment, -X1)
#fjerner litt krøll
sentiment = filter(sentiment, is.na(verdi) == FALSE) %>%
filter(., verdi < 5)
sentiment <- read_delim(here("content/data/AFINN-no-165.txt"), "|", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
sentiment$verdi = parse_number(sentiment$X1)
sentiment$tekst = gsub(pattern = "[-][012345]|[012345]", replacement = "", x = sentiment$X1)
sentiment$tekst = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
sentiment = select(sentiment, -X1)
#fjerner litt krøll
sentiment = filter(sentiment, is.na(verdi) == FALSE) %>%
filter(., verdi < 6)
temp = filter(sentiment, verdi == 0)
View(temp)
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n())
temp
knitr::kable(temp)
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n())
knitr::kable(temp)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3)
temp
?kable''
?kable'
?kable
?kable
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
spread(., verdi)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
spread(., verdi)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3)
?spread
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
spread(., verdi, tekst)
View(temp)
View(temp)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
spread(., tekst, verdi)
View(temp)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
spread(., verdi, tekst)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3)
?add_rownames
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
rowid_to_column()
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
rowid_to_column() %>%
spread(., verdi, tekst)
View(temp)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
spread(., verdi, tekst)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3)
temp = group_by(sentiment, verdi) %>%
mutate(verdi = as.factor(verdi)) %>%
sample_n(., 3) %>%
spread(., verdi, tekst)
temp = group_by(sentiment, verdi) %>%
mutate(verdi = as.factor(verdi)) %>%
sample_n(., 3)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
mutate(verdi = as.factor(verdi)) %>%
spread(., verdi, tekst)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3) %>%
ungroup() %>%
mutate(verdi = as.factor(verdi)) %>%
spread(., verdi, tekst)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3)
knitr::kable(temp)
df = inner_join(sentiment, df_programmer, by = c("tekst" = "term"))
#en utfordring her er at vi blander verdien på en variabel og antallet observasjoner
#bør ekspanderes
df_utvida = uncount(df, antall)
temp = count(df, tekst, sort = TRUE, wt = antall)
temp
?count
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment)
temp
#med TM
mappe <- here("content/data/valgprogram")
# lag et korpus fra pdf-filene
converted <- VCorpus(DirSource(mappe), readerControl = list(reader = readPDF, language = "nb")) %>%
DocumentTermMatrix(., control = list(language = "nb",
removePunctuation = TRUE,
removeNumbers = TRUE,
stopwords = stopwords("no")
))
#opprydding
#fjerner .pdf-suffixet
df_programmer = tidy(converted) %>%
mutate(., document = gsub(".pdf", "", document, fixed = TRUE))
#setter bedre navn på variablene
names(df_programmer) = c("parti", "term", "antall")
#sentiment-data
sentiment <- read_delim(here("content/data/AFINN-no-165.txt"), "|", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
sentiment$verdi = parse_number(sentiment$X1)
sentiment$tekst = gsub(pattern = "[-][012345]|[012345]", replacement = "", x = sentiment$X1)
sentiment$tekst = gsub(pattern = "\t", replacement = "", x = sentiment$tekst)
sentiment = select(sentiment, -X1)
#fjerner litt krøll - manglende verdier og ett ord med verdi 8
sentiment = filter(sentiment, is.na(verdi) == FALSE) %>%
filter(., verdi < 6)
#hvor mange ord er i hver kategori
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n())
knitr::kable(temp)
temp = group_by(sentiment, verdi) %>%
sample_n(., 3)
knitr::kable(temp)
df = inner_join(sentiment, df_programmer, by = c("tekst" = "term"))
#en utfordring her er at vi blander verdien på en variabel og antallet observasjoner
#bør ekspanderes
df_utvida = uncount(df, antall)
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment)
temp
?top_n
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
top_n(., 10)
temp
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
top_n(., 10, n)
temp
knitr::kable(temp)
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment)
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
top_n(., 10, n)
knitr::kable(temp)
?n
?count
temp = count(df_programmer, term, wt = antall)
temp = bind_rows(antall_ord_totalt = count(df_programmer, term, wt = antall))
temp = bind_rows(antall_ord_totalt = tally(df_programmer, term, wt = antall))
temp = bind_rows(antall_ord_totalt = tally(df_programmer, term))
temp = bind_rows(antall_ord_totalt = nrow(count(df_programmer, term, wt = antall)))
temp = bind_rows(antall_ord_totalt = nrows(count(df_programmer, term, wt = antall)))
?nrow
temp = bind_rows(antall_ord_totalt = nrow(count(df_programmer, term, wt = antall)))
nrow(count(df_programmer, term, wt = antall))
nrow(count(df, tekst, sort = TRUE, wt = antall))
#antall ord i programmene
nrow(count(df_programmer, term, wt = antall))
#antall ord i programmene som har en stemningskode
nrow(count(df, tekst, sort = TRUE, wt = antall))
temp = count(df, tekst, sort = TRUE, wt = antall)
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
group_by(., sentiment) %>%
summarise(., antall = n())
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment)
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
group_by(., verdi) %>%
summarise(., antall = n())
temp
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
top_n(., 10, n)
knitr::kable(temp)
temp =  group_by(df_utvida, parti) %>%
summarise(mean = mean(verdi))
ggplot(data = temp) +
geom_col(aes(x = fct_reorder(parti, mean), y = mean)) +
coord_flip() +
labs(title = "Høyre og KrF er de mest positive", subtitle = "Rødt og SV de mest negative", x = "Parti", y = "Gjennomsnittlig stemning")
temp =  group_by(df_utvida, parti) %>%
summarise(mean = mean(verdi))
ggplot(data = temp) +
geom_col(aes(x = fct_reorder(parti, mean), y = mean)) +
coord_flip() +
labs(title = "Høyre og KrF er de mest positive", subtitle = "Rødt og SV de mest negative", x = "Parti", y = "Gjennomsnittlig stemning")
View(temp)
ggplot(data = df_utvida, aes(x = fct_reorder(parti, verdi, .fun = mean), y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip()
#skal telle opp antall ord assosisert med hver enkelt følelses-verdi
temp = group_by(df_utvida, parti, verdi) %>%
summarise(., antall = n()) %>%
mutate(., andel = antall / sum(antall))
ggplot(data = temp) +
geom_col(aes(x = verdi, y = andel)) +
facet_wrap(~parti)
ggplot(data = df_utvida, aes(y = fct_reorder(parti, verdi, .fun = mean), x = verdi)) +
geom_density_ridges(alpha = 0.7) +
scale_x_continuous(limits = c(-5, 5), breaks = seq(from = -5, to = 5, by = 1), expand = c(0,0)) +
theme(axis.ticks.y = element_blank())
#skal telle opp antall ord assosisert med hver enkelt følelses-verdi
temp = group_by(df_utvida, parti, verdi) %>%
summarise(., antall = n()) %>%
mutate(., andel = antall / sum(antall))
ggplot(data = temp) +
geom_col(aes(x = verdi, y = andel)) +
facet_wrap(~parti)
?scale_x_continuous
?scale_x_discrete
ggplot(data = temp) +
geom_col(aes(x = verdi, y = andel)) +
facet_wrap(~parti) +
scale_x_discrete()
?seq
ggplot(data = temp) +
geom_col(aes(x = verdi, y = andel)) +
facet_wrap(~parti) +
scale_x_discrete(breaks = seq(from = -5, to = 5, by = 1))
ggplot(data = temp) +
geom_col(aes(x = verdi, y = andel)) +
facet_wrap(~parti) +
scale_x_continuous(breaks = seq(from = -5, to = 5, by = 1))
ggplot(data = df_utvida, aes(x = fct_reorder(parti, verdi, .fun = mean), y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip() +
scale_y_continuous(breaks = seq(from-5, to = 5, by = 1))
ggplot(data = df_utvida, aes(x = fct_reorder(parti, verdi, .fun = mean), y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip() +
scale_y_continuous(breaks = seq(from = -5, to = 5, by = 1))
?geom_boxplot
ggplot(data = df_utvida, aes(x = fct_reorder(parti, verdi, .fun = mean), y = verdi)) +
geom_jitter(colour = "steelblue", alpha = 0.1) +
geom_boxplot(alpha = 0.5) +
coord_flip() +
scale_y_continuous(breaks = seq(from = -5, to = 5, by = 1)) +
labs(x = "Parti", y = "Stemning")
blogdown:::serve_site()
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n()) %>%
qplot(data = ., x = verdi, y = antall)
temp
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n()) %>%
qplot(data = ., x = verdi, y = antall, geom = "bar")
temp
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n()) %>%
qplot(data = ., x = verdi, y = antall, geom = "col")
temp
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n()) %>%
qplot(data = ., x = verdi, y = antall, geom = "col") +
scale_x_continuous(breaks = seq(from = -5, to = 5, by = 1))
temp
temp = group_by(sentiment, verdi) %>%
sample_n(., 1)
knitr::kable(temp)
#hvor mange ord er i hver kategori
temp = group_by(sentiment, verdi) %>%
summarise(., antall = n()) %>%
qplot(data = ., x = verdi, y = antall, geom = "col") +
scale_x_continuous(breaks = seq(from = -5, to = 5, by = 1))
temp
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
group_by(., verdi) %>%
summarise(., antall = n())
qplot(data = ., x = verdi, y = antall, geom = "col") +
scale_x_continuous(breaks = seq(from = -5, to = 5, by = 1))
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
group_by(., verdi) %>%
summarise(., antall = n()) %>%
qplot(data = ., x = verdi, y = antall, geom = "col") +
scale_x_continuous(breaks = seq(from = -5, to = 5, by = 1))
temp
df = inner_join(sentiment, df_programmer, by = c("tekst" = "term"))
#en utfordring her er at vi blander verdien på en variabel og antallet observasjoner
#bør ekspanderes
df_utvida = uncount(df, antall)
#antall ord i programmene
nrow(count(df_programmer, term, wt = antall))
#antall ord i programmene som har en stemningskode
nrow(count(df, tekst, sort = TRUE, wt = antall))
temp = count(df, tekst, sort = TRUE, wt = antall) %>%
left_join(., sentiment) %>% #hekter også på ordene igjen
group_by(., verdi) %>%
summarise(., antall = n()) %>%
qplot(data = ., x = verdi, y = antall, geom = "col") +
scale_x_continuous(breaks = seq(from = -5, to = 5, by = 1))
temp
blogdown:::serve_site()
blogdown:::new_post_addin()
