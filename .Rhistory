uke = lubridate::week(fra),
month = lubridate::month(fra)
)
View(df)
df = mutate(df,
dato = as.Date(fra),
dag = lubridate::wday(fra, label = TRUE),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
df = mutate(df,
dato = as.Date(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
?lubridate::hour
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
library(tidyverse)
library(here)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
df = map_df(files, read_delim, delim = ";", escape_double = FALSE,
skip = 1,
col_names = c("fra", "til", "forbruk"),
col_types = cols(
fra = col_datetime(format = "%d.%m.%Y %H:%M"),
til = col_datetime(format = "%d.%m.%Y %H:%M")
),
locale = locale(decimal_mark = ",", grouping_mark = ""),
trim_ws = TRUE)
install.packages("tsibble")
library(tsibble)
?as_tsibble
temp = as_tsibble(df, indek = til)
temp = as_tsibble(df, index = til)
temp = duplicates(df)
temp = duplicates(df, index = til)
View(temp)
?duplicates
temp = mutate(df, duplikat = is_duplicated(df))
temp = mutate(df, duplikat = is_duplicated(df, index = fra))
View(temp)
df = select(df, fra, forbruk)
temp = mutate(df, duplikat = is_duplicated(df, index = fra))
View(temp)
temp = mutate(df, duplikat = are_duplicated(df, index = fra))
temp = distinct(df, fra)
duplikater = duplicates(df, index = fra)
View(duplikater)
df = select(df, fra, forbruk) %>%
distinct(., fra, .keep_all = TRUE)
test = as_tsibble(df, index = fra)
View(test)
#gjør det om til en tsibble
df = as_tsibble(df, index = fra)
#litt databearbeiding
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
str(df)
temp = group_by(df, time) %>%
summarise(., forbruk = sum(forbruk))
View(temp)
?index_by
temp = index_by(df, time) %>%
summarise(., forbruk = sum(forbruk))
ggplot(data = df) +
geom_smooth(aes(x = time, y = forbruk))
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_smooth() +
geom_point()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_point() +
geom_smooth()
ggplot(data = df, aes(x = time, y = forbruk, colour = dag)) +
geom_point() +
geom_smooth()
ggplot(data = df, aes(x = uke, y = forbruk)) +
geom_bar()
ggplot(data = df, aes(x = uke, y = forbruk)) +
geom_col()
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_point() +
geom_smooth()
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_jitter(alpha = 0.1) +
geom_smooth()
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_jitter(alpha = 0.3) +
geom_smooth()
library(tidyverse)
library(here)
library(tsibble)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
df = map_df(files, read_delim, delim = ";", escape_double = FALSE,
skip = 1,
col_names = c("fra", "til", "forbruk"),
col_types = cols(
fra = col_datetime(format = "%d.%m.%Y %H:%M"),
til = col_datetime(format = "%d.%m.%Y %H:%M")
),
locale = locale(decimal_mark = ",", grouping_mark = ""),
trim_ws = TRUE)
duplikater = duplicates(df, index = fra)
df = select(df, fra, forbruk) %>%
distinct(., fra, .keep_all = TRUE)
#gjør det om til en tsibble
df = as_tsibble(df, index = fra)
#litt databearbeiding
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_smooth()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_smooth(aes(colour = ukedag)) +
geom_boxplot(aes(group = time))
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_smooth(aes(colour = ukedag)) +
geom_boxplot(aes(group = time, alpha = 0.3))
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot(aes(group = time, alpha = 0.3)) +
geom_smooth(aes(colour = ukedag))
ggplot(data = df, aes(x = dato, y = forbruk)) +
geom_line()
temp = index_by(df, dato)
temp = index_by(df, dato) %>%
summarise(forbruk = sum(forbruk))
ggplot(data = temp, aes(x = dato, y = forbruk)) +
geom_line()
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
library(tidyverse)
library(here)
library(tsibble)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
df = map_df(files, read_delim, delim = ";", escape_double = FALSE,
skip = 1,
col_names = c("fra", "til", "forbruk"),
col_types = cols(
fra = col_datetime(format = "%d.%m.%Y %H:%M"),
til = col_datetime(format = "%d.%m.%Y %H:%M")
),
locale = locale(decimal_mark = ",", grouping_mark = ""),
trim_ws = TRUE)
duplikater = duplicates(df, index = fra)
df = select(df, fra, forbruk) %>%
distinct(., fra, .keep_all = TRUE)
#gjør det om til en tsibble
df = as_tsibble(df, index = fra)
#litt databearbeiding
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_smooth()
ggplot(data = df, aes(x = time, group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot(aes(group = time, alpha = 0.3)) +
geom_smooth(aes(colour = ukedag))
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_smooth()
ggplot(data = df, aes(x = time, group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot(aes(group = time), alpha = 0.3) +
geom_smooth(aes(colour = ukedag))
library(tidyverse)
library(here)
library(tsibble)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
df = map_df(files, read_delim, delim = ";", escape_double = FALSE,
skip = 1,
col_names = c("fra", "til", "forbruk"),
col_types = cols(
fra = col_datetime(format = "%d.%m.%Y %H:%M"),
til = col_datetime(format = "%d.%m.%Y %H:%M")
),
locale = locale(decimal_mark = ",", grouping_mark = ""),
trim_ws = TRUE)
duplikater = duplicates(df, index = fra)
df = select(df, fra, forbruk) %>%
distinct(., fra, .keep_all = TRUE)
#gjør det om til en tsibble
df = as_tsibble(df, index = fra)
#litt databearbeiding
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_smooth()
ggplot(data = df, aes(x = time, group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_smooth()
ggplot(data = df, aes(x = time, group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_smooth()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot(aes(group = time), alpha = 0.3) +
geom_smooth(aes(colour = ukedag))
ggplot(data = df, aes(x = fra, y = forbruk)) +
geom_line()
temp = index_by(df, dato) %>%
summarise(forbruk = sum(forbruk))
ggplot(data = temp, aes(x = dato, y = forbruk)) +
geom_line()
temp = arrange(df, fra)
View(temp)
temp = arrange(df, fra) %>%
index_by(., uke) %>%
summarise(forbruk = sum(forbruk))
ggplot(data = temp, aes(x = uke, y = forbruk)) +
geom_col()
View(temp)
temp = arrange(df, fra) %>%
mutate(nr = seq_along(uke)) %>%
index_by(., nr) %>%
summarise(forbruk = sum(forbruk)) %>%
temp = arrange(df, fra) %>%
mutate(nr = seq_along(uke)) %>%
index_by(., nr) %>%
summarise(forbruk = sum(forbruk))
ggplot(data = temp, aes(x = uke, y = forbruk)) +
geom_col()
ggplot(data = temp, aes(x = nr, y = forbruk)) +
geom_col()
temp = arrange(df, fra) %>%
group_by(uke) %>%
mutate(nr = seq_along(uke)) %>%
index_by(., nr) %>%
summarise(forbruk = sum(forbruk))
ggplot(data = temp, aes(x = nr, y = forbruk)) +
geom_col()
temp = arrange(df, fra) %>%
group_by(uke) %>%
mutate(nr = seq_along(uke)) %>%
summarise(forbruk = sum(forbruk))
temp = arrange(df, fra) %>%
group_by(uke) %>%
mutate(nr = seq_along(uke))
temp = arrange(df, fra) %>%
group_by(uke) %>%
summarise(forbruk = sum(forbruk))
temp = arrange(df, fra) %>%
index_by(uke) %>%
summarise(forbruk = sum(forbruk))
?autoplot
temp = index_by(df, dato) %>%
summarise(forbruk = sum(forbruk))
ggplot(data = temp, aes(x = dato, y = forbruk)) +
geom_line()
temp = index_by(df, dato) %>%
summarise(forbruk = sum(forbruk)) %>%
mutate(ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"))
temp = index_by(df, dato) %>%
summarise(forbruk = sum(forbruk)) %>%
mutate(
dag = lubridate::wday(dato, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag")
)
ggplot(data = temp, aes(x = dato, y = forbruk)) +
geom_line()
ggplot(data = temp, aes(x = dato, y = forbruk)) +
geom_line(aes(fill = ukedag))
ggplot(data = temp, aes(x = dato, y = forbruk)) +
geom_line(aes(colour = ukedag))
ggplot(data = temp) +
geom_line(aes(x = dato, y = forbruk)) +
geom_point(aes(x = dato, y = forbruk, colour = ukedag))
ggplot(data = temp) +
geom_line(aes(x = dato, y = forbruk))
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot(aes(group = ukedag), alpha = 0.3)
ggplot(data = df, aes(x = ukedag, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = ukedag, y = forbruk)) +
geom_boxplot() +
geom_jitter()
ggplot(data = df, aes(x = ukedag, y = forbruk)) +
geom_boxplot() +
geom_jitter(alpha = 0.1)
ggplot(data = temp, aes(x = ukedag, y = forbruk)) +
geom_boxplot() +
geom_jitter(alpha = 0.1)
ggplot(data = temp, aes(x = forbruk)) +
geom_histogram(aes(fill = ukedag))
ggplot(data = temp, aes(x = forbruk)) +
geom_density(aes(fill = ukedag))
?geom_density
ggplot(data = temp, aes(x = forbruk)) +
geom_freqpoly(aes(colour = ukedag))
ggplot(data = temp, aes(x = forbruk)) +
geom_densitu(aes(fill = ukedag), alpha = 0.3)
ggplot(data = temp, aes(x = forbruk)) +
geom_density(aes(fill = ukedag), alpha = 0.3)
?gg_seasons
??gg_season
?model
?stl
??model
model
model()
??fable.model
?components
??components
install.packages("fable")
library(fable)
?model
library(tidyverse)
library(here)
library(tsibble)
library(fable)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
df = map_df(files, read_delim, delim = ";", escape_double = FALSE,
skip = 1,
col_names = c("fra", "til", "forbruk"),
col_types = cols(
fra = col_datetime(format = "%d.%m.%Y %H:%M"),
til = col_datetime(format = "%d.%m.%Y %H:%M")
),
locale = locale(decimal_mark = ",", grouping_mark = ""),
trim_ws = TRUE)
duplikater = duplicates(df, index = fra)
df = select(df, fra, forbruk) %>%
distinct(., fra, .keep_all = TRUE)
#gjør det om til en tsibble
df = as_tsibble(df, index = fra)
#litt databearbeiding
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
ggplot(data = df, aes(x = fra, y = forbruk)) +
geom_line()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_smooth()
ggplot(data = df, aes(x = time, group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_smooth()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot(aes(group = time), alpha = 0.3) +
geom_smooth(aes(colour = ukedag))
temp = index_by(df, dato) %>%
summarise(forbruk = sum(forbruk)) %>%
mutate(
dag = lubridate::wday(dato, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag")
)
ggplot(data = temp) +
geom_line(aes(x = dato, y = forbruk))
ggplot(data = temp, aes(x = ukedag, y = forbruk)) +
geom_boxplot() +
geom_jitter(alpha = 0.1)
ggplot(data = temp, aes(x = forbruk)) +
geom_density(aes(fill = ukedag), alpha = 0.3)
?STL
??stl
?stl
??fable::STL
?classical_decomposition
?classical_decomposition
??classical_decomposition
?stl
dekomponert <-  df %>%
model(STL(forbruk))
library(devtools)
install.packages("devtools", lib="C:/Program Files/R/R-3.6.1/library")
install.packages("feasts", lib="C:/Program Files/R/R-3.6.1/library")
library(tidyverse)
library(here)
library(tsibble)
library(fable)
library(feasts)
library(tidyverse)
library(here)
library(tsibble)
library(fable)
library(feasts)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
#leser inn data
files= list.files(path = here("content/data/power/"), pattern = "*.csv", full.names = TRUE)
df = map_df(files, read_delim, delim = ";", escape_double = FALSE,
skip = 1,
col_names = c("fra", "til", "forbruk"),
col_types = cols(
fra = col_datetime(format = "%d.%m.%Y %H:%M"),
til = col_datetime(format = "%d.%m.%Y %H:%M")
),
locale = locale(decimal_mark = ",", grouping_mark = ""),
trim_ws = TRUE)
duplikater = duplicates(df, index = fra)
df = select(df, fra, forbruk) %>%
distinct(., fra, .keep_all = TRUE)
#gjør det om til en tsibble
df = as_tsibble(df, index = fra)
#litt databearbeiding
df = mutate(df,
dato = as.Date(fra),
time = lubridate::hour(fra),
dag = lubridate::wday(fra, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"),
uke = lubridate::week(fra),
month = lubridate::month(fra)
)
ggplot(data = df, aes(x = fra, y = forbruk)) +
geom_line()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_smooth()
ggplot(data = df, aes(x = time, group = time, y = forbruk)) +
geom_boxplot()
ggplot(data = df, aes(x = time, y = forbruk, colour = ukedag)) +
geom_smooth()
ggplot(data = df, aes(x = time, y = forbruk)) +
geom_boxplot(aes(group = time), alpha = 0.3) +
geom_smooth(aes(colour = ukedag))
temp = index_by(df, dato) %>%
summarise(forbruk = sum(forbruk)) %>%
mutate(
dag = lubridate::wday(dato, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag")
)
ggplot(data = temp) +
geom_line(aes(x = dato, y = forbruk))
ggplot(data = temp, aes(x = ukedag, y = forbruk)) +
geom_boxplot() +
geom_jitter(alpha = 0.1)
ggplot(data = temp, aes(x = forbruk)) +
geom_density(aes(fill = ukedag), alpha = 0.3)
dekomponert <-  df %>%
model(STL(forbruk))
components(dekomponert)
components(dekomponert) %>%
autoplot()
