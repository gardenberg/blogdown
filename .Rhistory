kostnad_andel = kostnad/`månedskostnad`,
`måned` = lubridate::month(periode_start, label = TRUE)
)
ggplot(aes(x = fct_reorder(måned, periode_start), y = kostnad, colour = produkt, group = produkt), data = filter(temp, produkt == "fastbeløp" | produkt == "innkjøpspris" | produkt == "trippelgaranti")) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Kostnaden til strøm er den desidert største")
temp = mutate(df_elpris,
time = lubridate::hour(periode_start),
dag = lubridate::wday(periode_start, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"))
ggplot(data = temp, aes(x = periode_start, y = ore_kwh)) +
geom_line() +
labs(title = "Prisen per kwH har falt gjennom perioden", x = "Dato", y = "Øre pr. kwH")
ggplot(data = temp, aes(x = time, y = ore_kwh)) +
geom_smooth() +
labs(title = "Strømmen koster mest rundt kl. 9 og kl. 18", subtitle = "Øre pr. kwH gjennom døgnet", x = "Time", y = "Øre pr. kwH")
temp = group_by(df_bill, periode_start, produkt) %>%
summarise(kostnad = sum(sum)) %>%
mutate(`månedskostnad` = sum(kostnad),
kostnad_andel = kostnad/`månedskostnad`,
`måned` = lubridate::month(periode_start, label = TRUE)
)
ggplot(aes(x = fct_reorder(måned, periode_start), y = kostnad, colour = produkt, group = produkt), data = temp) +
geom_line() +
labs(x = "Måned", y = "Kostnad")
ggplot(aes(x = fct_reorder(måned, periode_start), y = kostnad_andel, colour = produkt, group = produkt), data = temp) +
geom_line() +
labs(x = "Måned", y = "Andel av total kostnad")
temp = filter(df_bill, produkt == "innkjøpspris") %>%
mutate(kwh_pris_øre = (sum / forbruk_kwh)*100) %>%
arrange(periode_start)
ggplot(aes(x = fct_reorder(periode, periode_start), y = kwh_pris_øre, group = 1), data = temp) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Strømpris øre pr. kwh")
#hekter på strømforbruket
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
group_by(periode_start) %>%
mutate((kwh_pris_kr = (sum / forbruk_kwh)*100),
stromkostnad
)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd")
View(temp_power)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
group_by(periode_start)
View(df_bill)
temp = group_by(df_bill, periode_start) %>%
summarise(., sum(sum))
View(temp)
temp = group_by(df_bill, periode_start) %>%
summarise(., strømkostnad = sum(sum))
?pivot_wider
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
pivot_wider(names_from = produkt, values_from = sum)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd,
kwh_pris_øre = (sum / forbruk_kwh)*100
)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd,
kwh_pris_øre = (energikostnad / forbruk_kwh)*100
)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd,
kwh_pris_kr = (energikostnad / forbruk_kwh)
)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd,
kwh_pris_kr = (energikostnad / forbruk_kwh)
) %>%
select(periode, periode_start, forbruk_kwh, energikostnad, kwh_pris_kr)
'temp = left_join(temp, temp_power)'
temp = left_join(temp, temp_power)
temp = group_by(df_bill, periode_start) %>%
summarise(., strømkostnad = sum(sum))
#hekter på strømforbruket
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd,
kwh_pris_kr = (energikostnad / forbruk_kwh)
) %>%
select(periode, periode_start, forbruk_kwh, energikostnad, kwh_pris_kr)
temp = left_join(temp_power, temp)
temp = group_by(df_bill, periode_start) %>%
summarise(., totalkostnad = sum(sum))
#hekter på strømforbruket
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd,
kwh_pris_kr = (energikostnad / forbruk_kwh)
) %>%
select(periode, periode_start, forbruk_kwh, energikostnad, kwh_pris_kr)
temp = left_join(temp_power, temp)
temp_nettleie = filter(df_bill, produkt == "fastledd")
View(temp_nettleie)
temp_nettleie = filter(df_bill, produkt == "fastledd") %>%
pivot_wider(names_from = produkt, values_from = sum)
temp_nettleie = filter(df_bill, produkt == "fastledd") %>%
select(periode_start, nettleie = sum)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(energikostnad = innkjøpspris + energiledd,
kwh_pris_kr = (energikostnad / forbruk_kwh)
) %>%
select(periode, periode_start, forbruk_kwh, energikostnad, kwh_pris_kr)
#nettleie
temp_nettleie = filter(df_bill, produkt == "fastledd") %>%
select(periode_start, nettleie = sum)
temp = left_join(temp_power, temp_nettleie)
View(temp)
temp_leverandør = filter(df_bill, produkt == "fastbeløp" | produkt == "trippelgaranti") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum)
View(temp_leverandør)
temp_leverandør = filter(df_bill, produkt == "fastbeløp" | produkt == "trippelgaranti") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(leverandørkostnad = fastbeløp + trippelgaranti)
temp_leverandør = filter(df_bill, produkt == "fastbeløp" | produkt == "trippelgaranti") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(leverandørkostnad = fastbeløp + trippelgaranti) %>%
select(periode_start, leverandørkostnad)
temp = left_join(temp, temp_leverandør)
temp_total = group_by(df_bill, periode_start) %>%
summarise(., totalkostnad = sum(sum))
temp = left_join(temp, temp_total)
temp = mutate(temp, sjekk = energikostnad + nettleie + leverandørkostnad)
View(temp_power)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum)
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(strømpris_påslag_kr = 5.49/100,
strømpris_påslag_total = strømpris_påslag_kr * forbruk_kwh,
energikostnad = innkjøpspris + energiledd - (strømpris_påslag_kr*forbruk_kwh),
kwh_pris_kr = (energikostnad / forbruk_kwh)
) %>%
select(periode, periode_start, forbruk_kwh, kwh_pris_kr, strømpris_påslag_kr, energikostnad, strømpris_påslag_total)
#strømforbruket
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(strømpris_påslag_kr = 5.49/100,
strømpris_påslag_total = strømpris_påslag_kr * forbruk_kwh,
energikostnad = innkjøpspris + energiledd - (strømpris_påslag_kr*forbruk_kwh),
kwh_pris_kr = (energikostnad / forbruk_kwh)
) %>%
select(periode, periode_start, forbruk_kwh, kwh_pris_kr, strømpris_påslag_kr, energikostnad, strømpris_påslag_total)
#nettleie
temp_nettleie = filter(df_bill, produkt == "fastledd") %>%
select(periode_start, nettleie = sum)
temp = left_join(temp_power, temp_nettleie)
#leverandørkostnad
temp_leverandør = filter(df_bill, produkt == "fastbeløp" | produkt == "trippelgaranti") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(leverandørkostnad = fastbeløp + trippelgaranti) %>%
select(periode_start, leverandørkostnad)
temp = left_join(temp, temp_leverandør)
#totalkostnad
temp_total = group_by(df_bill, periode_start) %>%
summarise(., totalkostnad = sum(sum))
temp = left_join(temp, temp_total)
temp = mutate(temp, sjekk = energikostnad + nettleie + leverandørkostnad)
View(temp)
temp = mutate(temp, sjekk = energikostnad + nettleie + leverandørkostnad + strømpris_påslag_total)
temp = mutate(temp,
strømregning = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
ggplot(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), data = temp) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Strømregning")
parametre = select(temp, periode, periode_start, kwh_pris_kr, forbruk_kwh, leverandørkostnad, strømpris_påslag_kr, nettleie)
paramentre$sjekk = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie
parametre = mutate(parametre, sjekk = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
View(parametre)
sum(parametr$sjekk)
sum(parametre$sjekk)
sum(temp$strømregning)
graf = ggplot(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), data = temp) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Strømregning")
graf
scenario_2 = mutate(parametre, forbruk_kwh = (forbruk_kwh*0.8),
faktisk_kostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
graf = graf + geom_line(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), data = scenario_2)
graf
View(scenario_2)
parametre = mutate(parametre, totalkostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
graf = ggplot(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), data = parametre) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Strømregning")
graf
scenario_2 = mutate(parametre, forbruk_kwh = (forbruk_kwh*0.8),
faktisk_kostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
graf = graf + geom_line(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), data = scenario_2)
graf
graf = ggplot(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), data = parametre) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Strømregning")
graf
graf = graf + geom_line(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), colour = "red", data = scenario_2)
graf
graf = ggplot() +
geom_line(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), data = parametre) +
labs(x = "måned", y = "kostnad", title = "Strømregning")
graf
graf = graf + geom_line(aes(x = fct_reorder(periode, periode_start), y = totalkostnad, group = 1), colour = "red", data = scenario_2)
graf
temp = mutate(parametre,
totalkostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie) %>%
select(periode, periode_start, faktisk_totalkostnad = totalkostnad)
temp = left_join(temp, select(scenario_2, periode_start, scenario_2_kostnad))
scenario_2 = mutate(parametre, forbruk_kwh = (forbruk_kwh*0.8),
scenario_2_kostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
temp = left_join(temp, select(scenario_2, periode_start, scenario_2_kostnad))
scenario_3 = mutate(parametre, leverandørkostnad = 0,
strømpris_påslag_kr = 0,
scenario_3_kostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
temp = left_join(temp, select(scenario_3, periode_start, scenario_3_kostnad))
?pivot_longer
temp = pivot_longer(temp, cols = 3:5, names_to = "scenario", values_to = "kostnad")
View(temp)
ggplot(data = temp, aes(x = periode_start, y = kosntad, colour = scenario))
ggplot(data = temp, aes(x = periode_start, y = kostnad, colour = scenario)) +
geom_line()
library(tidyverse)
library(here)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
#data
#strømregninger
df_bill <- read_delim(here("content/data/power/bills.csv"), ";", escape_double = FALSE,
locale = locale(decimal_mark = ",", grouping_mark = "|", encoding = "ISO-8859-1"),
col_types = cols(
periode_start = col_date(format = "%d.%m.%Y"),
periode_stopp = col_date(format = "%d.%m.%Y")
),
trim_ws = TRUE)
#strømpriser
temp1 <- read_delim(here("content/data/power/nordpool_elspotprices_2019_hourly.csv"), ";", escape_double = FALSE, locale = locale(decimal_mark = ",",grouping_mark = "|", encoding = "ISO-8859-1"), trim_ws = TRUE)
temp2 <- read_delim(here("content/data/power/nordpool_elspotprices_2020_hourly.csv"), ";", escape_double = FALSE, locale = locale(decimal_mark = ",",grouping_mark = "|", encoding = "ISO-8859-1"), trim_ws = TRUE)
df_elpris = bind_rows(temp1, temp2) %>%
separate(Hours, into = c("hour_start", NA), sep = 2) %>%
mutate(periode_start = paste0(X1, "-", hour_start, ":00"),
periode_start = as.POSIXct(periode_start, format = "%d.%m.%Y-%H:%M"),
ore_kwh = round(Oslo/10, digits = 2)
) %>%
select(periode_start, ore_kwh)
#strømforbruk
files= list.files(path = here("content/data/power/consumption"), pattern = "*.csv", full.names = TRUE)
df_consumption = map_df(files, read_delim, delim = ";", escape_double = FALSE,
skip = 1,
col_names = c("fra", "til", "forbruk"),
col_types = cols(
fra = col_datetime(format = "%d.%m.%Y %H:%M"),
til = col_datetime(format = "%d.%m.%Y %H:%M")
),
locale = locale(decimal_mark = ",", grouping_mark = ""),
trim_ws = TRUE)
df_consumption = select(df_consumption, fra, forbruk) %>%
distinct(., fra, .keep_all = TRUE)
rm(files, temp1, temp2)
temp = group_by(df_bill, periode_start) %>%
summarise(kostnad = sum(sum)) %>%
mutate(`måned` = lubridate::month(periode_start, label = TRUE)) %>%
arrange(periode_start)
ggplot(data = temp, aes(x = fct_reorder(måned, desc(periode_start)), y = kostnad)) +
geom_col() +
coord_flip() +
labs(x = "måned", y = "kostnad")
ggplot(data = temp, aes(x = fct_reorder(måned, periode_start), y = kostnad, group = 1)) +
geom_line() +
labs(x = "måned", y = "kostnad")
#spørsmål 1 - klarer jeg å gjenskape strømregninga med forbruk og pris?
#forbruk
df = left_join(df_consumption, df_elpris, by = c("fra" = "periode_start")) %>%
mutate(
month = lubridate::month(fra, label = TRUE, abbr = FALSE)
)
temp = group_by(df, month) %>%
summarise(sum_forbruk_elhub = sum(forbruk))
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, forbruk_kwh_bill = forbruk_kwh) %>%
left_join(temp, ., by = c("month" = "periode"))
#ja
#kostnad
temp = group_by(df, month) %>%
mutate(kr_kostnad = (forbruk*(ore_kwh+5.49))/100) %>%
summarise(sum_kr_kostnad = sum(kr_kostnad, na.rm = TRUE))
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, regning_kostnad = sum) %>%
left_join(temp, ., by = c("month" = "periode"))
#nope.
temp = group_by(df_bill, periode_start, type) %>%
summarise(kostnad = sum(sum)) %>%
mutate(`månedskostnad` = sum(kostnad),
kostnad_andel = kostnad/`månedskostnad`,
`måned` = lubridate::month(periode_start, label = TRUE)
)
ggplot(aes(x = fct_reorder(måned, periode_start), y = kostnad, fill = type), data = temp) +
geom_col(position = "dodge") +
labs(x = "måned", title = "Utgiftene til strømleverandøren varierer fra 150 til 1000 kroner", subtitle = "men nettleia er nesten alltid høyere")
temp = group_by(df_bill, periode_start, produkt) %>%
summarise(kostnad = sum(sum)) %>%
mutate(`månedskostnad` = sum(kostnad),
kostnad_andel = kostnad/`månedskostnad`,
`måned` = lubridate::month(periode_start, label = TRUE)
)
ggplot(aes(x = fct_reorder(måned, periode_start), y = kostnad, colour = produkt, group = produkt), data = filter(temp, produkt == "fastbeløp" | produkt == "innkjøpspris" | produkt == "trippelgaranti")) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Kostnaden til strøm er den desidert største")
temp = mutate(df_elpris,
time = lubridate::hour(periode_start),
dag = lubridate::wday(periode_start, label = TRUE, abbr = FALSE),
ukedag = ifelse(dag %in% c("lørdag", "søndag"), "helg", "arbeidsdag"))
ggplot(data = temp, aes(x = periode_start, y = ore_kwh)) +
geom_line() +
labs(title = "Prisen per kwH har falt gjennom perioden", x = "Dato", y = "Øre pr. kwH")
ggplot(data = temp, aes(x = time, y = ore_kwh)) +
geom_smooth() +
labs(title = "Strømmen koster mest rundt kl. 9 og kl. 18", subtitle = "Øre pr. kwH gjennom døgnet", x = "Time", y = "Øre pr. kwH")
temp = group_by(df_bill, periode_start, produkt) %>%
summarise(kostnad = sum(sum)) %>%
mutate(`månedskostnad` = sum(kostnad),
kostnad_andel = kostnad/`månedskostnad`,
`måned` = lubridate::month(periode_start, label = TRUE)
)
ggplot(aes(x = fct_reorder(måned, periode_start), y = kostnad, colour = produkt, group = produkt), data = temp) +
geom_line() +
labs(x = "Måned", y = "Kostnad")
ggplot(aes(x = fct_reorder(måned, periode_start), y = kostnad_andel, colour = produkt, group = produkt), data = temp) +
geom_line() +
labs(x = "Måned", y = "Andel av total kostnad")
temp = filter(df_bill, produkt == "innkjøpspris") %>%
mutate(kwh_pris_øre = (sum / forbruk_kwh)*100) %>%
arrange(periode_start)
ggplot(aes(x = fct_reorder(periode, periode_start), y = kwh_pris_øre, group = 1), data = temp) +
geom_line() +
labs(x = "måned", y = "kostnad", title = "Strømpris øre pr. kwh")
View(df_bill)
temp = select(df_bill, periode_start, forbruk_kwh) %>%
distinct(periode_start)
View(temp)
?distinct
temp = select(df_bill, periode_start, forbruk_kwh) %>%
distinct(periode_start, .keep_all = TRUE)
temp = select(df_bill, periode_start, forbruk_kwh) %>%
filter(is.na(forbruk_kwh)=FALSE)
temp = select(df_bill, periode_start, forbruk_kwh) %>%
filter(is.na(forbruk_kwh) == FALSE)
temp = select(df_bill, periode_start, forbruk_kwh) %>%
filter(is.na(forbruk_kwh) == FALSE) %>%
distinct(., .keep_all = TRUE)
temp_total = group_by(df_bill, periode_start) %>%
summarise(., totalkostnad = sum(sum))
temp = left_join(temp, temp_total)
modell_1 = lm(data = temp, totalkostnad ~ forbruk_kwh)
View(modell_1)
??broom
temp = augment(modell_1)
temp = broom::augment(modell_1)
broom::glance(modell_1)
broom::glance(modell_1)
ggplot(data = temp) +
geom_line(aes(x = forbruk_kwh, y = totalkostnad))
ggplot(data = temp) +
geom_line(aes(x = forbruk_kwh, y = totalkostnad)) +
geom_line(aes(x = forbruk_kwh, y = .fitted), colour = "grey")
ggplot(data = temp) +
geom_line(aes(x = forbruk_kwh, y = totalkostnad)) +
geom_point(aes(x = forbruk_kwh, y = totalkostnad)) +
geom_line(aes(x = forbruk_kwh, y = .fitted), colour = "grey")
broom::glance(modell_1)
??kable
??knitr::kable
knitr::kable(broom::glance(modell_1))
knitr::kable(broom::glance(modell_1))
summary(modell_1)
#strømforbruket
temp_power = filter(df_bill, produkt == "innkjøpspris" | produkt == "energiledd") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(strømpris_påslag_kr = 5.49/100,
strømpris_påslag_total = strømpris_påslag_kr * forbruk_kwh,
energikostnad = innkjøpspris + energiledd - (strømpris_påslag_kr*forbruk_kwh),
kwh_pris_kr = (energikostnad / forbruk_kwh)
) %>%
select(periode, periode_start, forbruk_kwh, kwh_pris_kr, strømpris_påslag_kr, energikostnad, strømpris_påslag_total)
#nettleie
temp_nettleie = filter(df_bill, produkt == "fastledd") %>%
select(periode_start, nettleie = sum)
temp = left_join(temp_power, temp_nettleie)
#leverandørkostnad
temp_leverandør = filter(df_bill, produkt == "fastbeløp" | produkt == "trippelgaranti") %>%
select(., -type) %>%
pivot_wider(names_from = produkt, values_from = sum) %>%
mutate(leverandørkostnad = fastbeløp + trippelgaranti) %>%
select(periode_start, leverandørkostnad)
temp = left_join(temp, temp_leverandør)
#totalkostnad
temp_total = group_by(df_bill, periode_start) %>%
summarise(., totalkostnad = sum(sum))
temp = left_join(temp, temp_total)
temp = mutate(temp,
strømregning = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
parametre = select(temp, periode, periode_start, kwh_pris_kr, forbruk_kwh, leverandørkostnad, strømpris_påslag_kr, nettleie)
temp = mutate(parametre,
totalkostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie) %>%
select(periode, periode_start, faktisk_totalkostnad = totalkostnad)
#hvor mye har en 20 % reduksjon i forbruk
scenario_2 = mutate(parametre, forbruk_kwh = (forbruk_kwh*0.9),
scenario_2_kostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
temp = left_join(temp, select(scenario_2, periode_start, scenario_2_kostnad))
#nuller alle kostnader
scenario_3 = mutate(parametre, leverandørkostnad = 0,
strømpris_påslag_kr = 0,
scenario_3_kostnad = (kwh_pris_kr*forbruk_kwh) + leverandørkostnad + (strømpris_påslag_kr * forbruk_kwh) + nettleie)
temp = left_join(temp, select(scenario_3, periode_start, scenario_3_kostnad))
temp = pivot_longer(temp, cols = 3:5, names_to = "scenario", values_to = "kostnad")
ggplot(data = temp, aes(x = periode_start, y = kostnad, colour = scenario)) +
geom_line()
innsparing = group_by(temp, scenario) %>%
summarise(kostnad = sum(kostnad))
View(innsparing)
innsparing = group_by(temp, scenario) %>%
summarise(kostnad = sum(kostnad)) %>%
arrange(kostnad)
knitr::kable(innsparing)
knitr::kable(innsparing)
blogdown:::serve_site()
#spørsmål 1 - klarer jeg å gjenskape strømregninga med forbruk og pris?
#forbruk
df = left_join(df_consumption, df_elpris, by = c("fra" = "periode_start")) %>%
mutate(
month = lubridate::month(fra, label = TRUE, abbr = FALSE)
)
temp = group_by(df, month) %>%
summarise(sum_forbruk_elhub = sum(forbruk))
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, forbruk_kwh_bill = forbruk_kwh) %>%
left_join(temp, ., by = c("month" = "periode"))
#ja
#kostnad
temp = group_by(df, month) %>%
mutate(kr_kostnad = (forbruk*(ore_kwh+5.49))/100) %>%
summarise(sum_kr_kostnad = sum(kr_kostnad, na.rm = TRUE))
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, regning_kostnad = sum) %>%
left_join(temp, ., by = c("month" = "periode"))
#nope.
View(temp)
View(temp2)
temp = group_by(df, month) %>%
summarise(sum_forbruk_elhub = sum(forbruk))
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, forbruk_kwh_bill = forbruk_kwh) %>%
left_join(temp, ., by = c("month" = "periode"))
ggplot() +
geom_col(aes(x = month, y = sum_forbruk_elhub), data = temp2) +
geom_col(aes(x = month, y = forbruk_kwh_bill), data = temp2)
ggplot() +
geom_col(aes(x = month, y = sum_forbruk_elhub), data = temp2, colour = "grey") +
geom_col(aes(x = month, y = forbruk_kwh_bill), data = temp2)
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, forbruk_kwh_bill = forbruk_kwh) %>%
left_join(temp, ., by = c("month" = "periode")) %>%
pivot_longer(., cols = 2:3, names_to = "type", values_to = "forbruk")
ggplot() +
geom_col(aes(x = month, y = sum_forbruk_elhub, fill = type), data = temp2)
ggplot() +
geom_col(aes(x = month, y = forbruk, fill = type), data = temp2)
ggplot() +
geom_col(aes(x = month, y = forbruk, fill = type), position = dodge, data = temp2)
ggplot() +
geom_col(aes(x = month, y = forbruk, fill = type), position = "dodge", data = temp2)
temp = group_by(df, month) %>%
mutate(kr_kostnad = (forbruk*(ore_kwh+5.49))/100) %>%
summarise(sum_kr_kostnad = sum(kr_kostnad, na.rm = TRUE))
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, regning_kostnad = sum) %>%
left_join(temp, ., by = c("month" = "periode"))
temp = group_by(df, month) %>%
mutate(kr_kostnad = (forbruk*(ore_kwh+5.49))/100) %>%
summarise(sum_kr_kostnad = sum(kr_kostnad, na.rm = TRUE))
temp2 = filter(df_bill, produkt == "innkjøpspris") %>%
select(periode, regning_kostnad = sum) %>%
left_join(temp, ., by = c("month" = "periode"))%>%
pivot_longer(., cols = 2:3, names_to = "type", values_to = "kostnad")
ggplot() +
geom_col(aes(x = month, y = kostnad, fill = type), position = "dodge", data = temp2)
