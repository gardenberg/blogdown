)) %>%
expand(nesting(year, month), antall)
test = ungroup(temp) %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
expand(year, month)
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
))
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
))
test = expand(year, month)
test = expand(temp, year, month)
test = left_join(expand(temp, year, month), temp)
View(test)
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .) %>%
mutate(antall = ifelse(isna(antall), 0, antall))
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
View(temp)
sum(temp$antall)
ggplot(data = filter(temp, year == 2015)) +
geom_line(aes(x = as.integer(month), y = antall, colour = as.factor(year))) +
scale_x_continuous(limits = c(1, 12), breaks = 1:12, minor_breaks = NULL) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Fra 1 til 3 ganger i uka i 2015")
ggplot(data = filter(temp, year <= 2016)) +
geom_line(aes(x = as.integer(month), y = antall, colour = as.factor(year))) +
scale_x_continuous(limits = c(1, 12), breaks = 1:12, minor_breaks = NULL) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Utflating andre halvdel av 2016")
ggplot(data = filter(temp, year == 2015)) +
geom_line(aes(x = month, y = antall, colour = as.factor(year))) +
scale_x_continuous(limits = c(1, 12), breaks = 1:12, minor_breaks = NULL) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Fra 1 til 3 ganger i uka i 2015", subtitle = "I hvert fall fra oppstarten på høsten")
ggplot(data = filter(temp, year == 2015)) +
geom_line(aes(x = month, y = antall, colour = as.factor(year))) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Fra 1 til 3 ganger i uka i 2015", subtitle = "I hvert fall fra oppstarten på høsten")
ggplot(data = filter(temp, year == 2015)) +
geom_line(aes(x = month, y = antall, colour = as.factor(year), group = 1)) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Fra 1 til 3 ganger i uka i 2015", subtitle = "I hvert fall fra oppstarten på høsten")
ggplot(data = filter(temp, year == 2015)) +
geom_line(aes(x = as.integer(month), y = antall, colour = as.factor(year))) +
scale_x_continuous(limits = c(1, 12), breaks = 1:12, minor_breaks = NULL) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Fra 1 til 3 ganger i uka i 2015", subtitle = "I hvert fall fra oppstarten på høsten")
ggplot(data = filter(temp, year <= 2016)) +
geom_line(aes(x = as.integer(month), y = antall, colour = as.factor(year))) +
scale_x_continuous(limits = c(1, 12), breaks = 1:12, minor_breaks = NULL) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Utflating andre halvdel av 2016")
ggplot(data = filter(temp, year <= 2017)) +
geom_line(aes(x = as.integer(month), y = antall, colour = as.factor(year))) +
scale_x_continuous(limits = c(1, 12), breaks = 1:12, minor_breaks = NULL) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Noe aktivitet i permisjonen, men så...")
?week
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
ggplot(data = filter(temp, year == 2015)) +
geom_line(aes(x = as.integer(month), y = antall, colour = as.factor(year))) +
scale_x_continuous(limits = c(1, 12), breaks = 1:12, minor_breaks = NULL) +
scale_y_continuous(limits = c(0, 12), breaks = seq(from = 1, to = 12, by = 3), minor_breaks = NULL) +
labs(x = "Måned", y = "Antall", colour = "År", title = "Fra 1 til 3 ganger i uka i 2015", subtitle = "I hvert fall fra oppstarten på høsten")
?week
df = select(sessions, start_time, end_time, duration, pause_duration, distance, elevation_gain, elevation_loss, average_speed, max_speed, duration_per_km, longitude, latitude, pulse_avg, pulse_max, notes) %>%
mutate(start_time = as.POSIXct(start_time/1000, origin="1970-01-01"),
end_time = as.POSIXct(end_time/1000, origin="1970-01-01"),
year = year(start_time),
month = month(start_time),
week = week(start_time),
duration_sec = round(duration/1000, 0),
duration_min = duration_sec/60,
duration_lubridate = as.duration(as.period(duration_sec, unit = "seconds")),
distance = distance / 1000, #konverterer distanse i meter til kilometer
duration_per_km_lubridate = as.duration(as.period(round(duration_per_km/1000, 0), unit = "seconds")),
duration_per_km = (duration_per_km/1000)/60
)
View(df)
temp = group_by(df, year, week) %>%
summarise(antall = n())
View(temp)
summary(temp$week)
test = expand(temp, year, week = 1:52)
5*52
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup() %>%
left_join(expand(temp, year, week = 1:52), .)
View(temp)
summary(temp$antall)
ggplot(data = temp) +
geom_bar(aes(x = antall))
?geom_bar
?facet_wrap
ggplot(data = temp) +
geom_bar(aes(x = antall)) +
facet_wrap(vars(year))
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup() %>%
left_join(expand(temp, year, week = 1:52), .) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
ggplot(data = temp) +
geom_bar(aes(x = antall)) +
facet_wrap(vars(year))
ggplot(data = temp) +
geom_bar(aes(x = antall)) +
facet_wrap(vars(year)) +
labs(x = "Antall turer i uka", y = "Antall uker", title = "Et stykke unna målet om 3 turer i uka")
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
))
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .)
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .) %>%
mutate(., antall = ifelse(is.na(antall), 0, antall))
temp = group_by(df, month, year) %>%
summarise(antall = n()) %>%
ungroup() %>%
mutate(month = fct_recode(as.factor(month),
januar = "1",
februar = "2",
mars = "3",
april = "4",
mai = "5",
juni = "6",
juli = "7",
august = "8",
september = "9",
oktober = "10",
november = "11",
desember = "12"
)) %>%
left_join(expand(temp, year, month), .)
library(tidyverse)
library(lubridate)
#settings
theme_set(theme_minimal())
set.seed(1106)
options(scipen = 100)
sessions <- read.csv2(here::here("content/data/runtastic/sesssions.csv"), stringsAsFactors=FALSE)
df = select(sessions, start_time, end_time, duration, pause_duration, distance, elevation_gain, elevation_loss, average_speed, max_speed, duration_per_km, longitude, latitude, pulse_avg, pulse_max, notes) %>%
mutate(start_time = as.POSIXct(start_time/1000, origin="1970-01-01"),
end_time = as.POSIXct(end_time/1000, origin="1970-01-01"),
year = year(start_time),
month = month(start_time),
week = week(start_time),
duration_sec = round(duration/1000, 0),
duration_min = duration_sec/60,
duration_lubridate = as.duration(as.period(duration_sec, unit = "seconds")),
distance = distance / 1000, #konverterer distanse i meter til kilometer
duration_per_km_lubridate = as.duration(as.period(round(duration_per_km/1000, 0), unit = "seconds")),
duration_per_km = (duration_per_km/1000)/60
)
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup() %>%
left_join(expand(temp, year, week = 1:52), .) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup()
temp = left_join(expand(temp, year, week = 1:52), .) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall))
ggplot(data = temp) +
geom_bar(aes(x = antall)) +
facet_wrap(vars(year)) +
labs(x = "Antall turer i uka", y = "Antall uker", title = "Et stykke unna målet om 3 turer i uka")
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup()
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall)) %>%
mutate(yearweek = paste0(year, week))
ggplot(data = temp) +
geom_bar(aes(x = antall)) +
facet_wrap(vars(year)) +
labs(x = "Antall turer i uka", y = "Antall uker", title = "Et stykke unna målet om 3 turer i uka")
View(temp)
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall)) %>%
mutate(yearweek = ifelse(length(week) == 1, paste0(0, week), week),
yearweek = paste0(year, week))
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup()
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall)) %>%
mutate(yearweek = ifelse(length(week) == 1, paste0(0, week), week),
yearweek = paste0(year, week))
View(temp)
length(temp$week)
length(temp$week)[1]
length(temp$week)[[1]]
length(temp$week[[1]])
length(temp$week[[10]])
nchar(temp$week[[10]])
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup()
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall)) %>%
mutate(yearweek = ifelse(nchar(week) == 1, paste0(0, week), week),
yearweek = paste0(year, week))
View(temp)
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup()
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall)) %>%
mutate(yearweek = ifelse(nchar(week) == 1, paste0(0, week), week),
yearweek = paste0(year, yearweek))
View(temp)
ggplot(data = temp) +
geom_col(aes(x = yearweek, y = antall))
ggplot(data = temp) +
geom_smooth(aes(x = yearweek, y = antall))
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall))
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1))
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup()
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall)) %>%
mutate(yearweek = ifelse(nchar(week) == 1, paste0(0, week), week),
yearweek = as.numeric(paste0(year, yearweek)))
ggplot(data = temp) +
geom_bar(aes(x = antall)) +
facet_wrap(vars(year)) +
labs(x = "Antall turer i uka", y = "Antall uker", title = "Et stykke unna målet om 3 turer i uka")
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1))
temp = group_by(df, year, week) %>%
summarise(antall = n()) %>%
ungroup()
temp = left_join(expand(temp, year, week = 1:52), temp) %>%
mutate(antall = ifelse(is.na(antall), 0, antall)) %>%
mutate(yearweek = ifelse(nchar(week) == 1, paste0(0, week), week),
yearweek = paste0(year, yearweek))
ggplot(data = temp) +
geom_bar(aes(x = antall)) +
facet_wrap(vars(year)) +
labs(x = "Antall turer i uka", y = "Antall uker", title = "Et stykke unna målet om 3 turer i uka")
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1))
temp2 = group_by(temp, year, antall) %>%
summarise(antall = sum(antall)) %>%
mutate(total = sum(antall))
temp2 = group_by(temp, year, antall) %>%
summarise(antall = sum(antall)) %>%
ungroup() %>%
mutate(total = sum(antall))
temp2 = group_by(temp, year, antall) %>%
summarise(antall_år = sum(antall)) %>%
ungroup() %>%
mutate(total = sum(antall))
View(temp2)
?ungroup
temp2 = group_by(temp, year, antall) %>%
summarise(antall_år = sum(antall)) %>%
ungroup() %>%
group_by(year) %>%
mutate(total = sum(antall))
temp2 = group_by(temp, year, antall) %>%
summarise(antall_år = sum(antall)) %>%
ungroup() %>%
group_by(year) %>%
mutate(total = sum(antall_år))
temp2 = group_by(temp, year, antall) %>%
summarise(antall_år = sum(antall)) %>%
ungroup() %>%
group_by(year) %>%
mutate(total = sum(antall_år)) %>%
mutate(andel = antall_år/total)
temp2 = group_by(temp, year, antall) %>%
summarise(n = n(antall)) %>%
ungroup() %>%
group_by(year) %>%
mutate(total = sum(antall_år)) %>%
mutate(andel = antall_år/total)
temp2 = group_by(temp, year, antall) %>%
summarise(n = n()) %>%
ungroup() %>%
group_by(year) %>%
mutate(total = sum(antall_år)) %>%
mutate(andel = antall_år/total)
temp2 = group_by(temp, year, antall) %>%
summarise(n = n()) %>%
ungroup() %>%
group_by(year) %>%
mutate(total = sum(n)) %>%
mutate(andel = n/total)
sum(temp2$n)
View(temp2)
temp2 = group_by(temp, year, antall) %>%
summarise(n = n())
temp2 = group_by(temp, year, antall) %>%
summarise(antall_uker = n()) %>%
mutate(andel = antall_uker/52)
ggplot(data = temp2) +
geom_col(aes(x = antall, y = andel)) +
facet_wrap(vars(year))
ggplot(data = temp2) +
geom_col(aes(x = antall, y = andel, colour = as.factor(year)))
?geom_col
ggplot(data = temp2) +
geom_col(aes(x = antall, y = andel, colour = as.factor(year)), position = "dodge")
ggplot(data = temp2) +
geom_col(aes(x = antall, y = andel, fill = as.factor(year)), position = "dodge")
ggplot(data = temp2) +
geom_col(aes(x = antall, y = andel, fill = as.factor(year)), position = "dodge") +
labs(x = "Antall aktiviteter per uke", y = "Andel uker hvert år", fill = "År")
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1))
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1)) +
scale_x_discrete(minor_breaks = NULL)
?scale_x_discrete
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1)) +
scale_x_discrete(breaks = NULL)
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1)) +
scale_x_discrete(breaks = c("201501", "201601", "201701", "201801", "201901"))
ggplot(data = temp) +
geom_line(aes(x = yearweek, y = antall, group = 1)) +
scale_x_discrete(breaks = c("201501", "201601", "201701", "201801", "201901")) +
scale_y_continuous(minor_breaks = NULL)
