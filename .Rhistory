waffle(andel_utgifter)
View(temp)
andel_utgifter
library(colorspace)
qualitative_hcl(11,"Dynamic")
waffle(andel_utgifter, colors=qualitative_hcl(11,"Dynamic"))
temp <- filter(df,region=="Landet uten Oslo")%>%
arrange(.,desc(value))%>%
mutate(.,andel = (value/sum(value))*100)
andel_utgifter = temp$value
names(andel_utgifter) = temp$funksjon
waffle(andel_utgifter, colors=qualitative_hcl(11,"Dynamic"))
waffle(andel_utgifter, colors=qualitative_hcl(11,"Dark 3"))
temp <- filter(df,region=="Landet uten Oslo")%>%
arrange(.,desc(value))%>%
mutate(.,andel = round((value/sum(value))*100),0)
temp <- filter(df,region=="Landet uten Oslo")%>%
arrange(.,desc(value))%>%
mutate(.,andel = round((value/sum(value))*100,0)
temp <- filter(df,region=="Landet uten Oslo")%>%
temp <- filter(df,region=="Landet uten Oslo")%>%
arrange(.,desc(value))%>%
mutate(.,andel = round((value/sum(value))*100,0))
sum(temp$andel)
temp <- filter(df,region=="Landet uten Oslo")%>%
arrange(.,desc(value))%>%
mutate(.,andel = round(value,0))
sum(temp$andel)
andel_utgifter = temp$andel
names(andel_utgifter) = temp$funksjon
waffle(andel_utgifter, colors=qualitative_hcl(11,"Dark 3"))
waffle(andel_utgifter, colors=qualitative_hcl(10,"Dark 3"))
waffle(andel_utgifter, colors=qualitative_hcl(10,"Dark 3"), xlab="1 rute = 1 prosent", title= "Fylkeskommunale utgifter etter område")
waffle(andel_utgifter, colors=qualitative_hcl(10,"Dark 3"), xlab="1 rute = 1 prosent", title= "Fylkeskommunale utgifter etter område", legend_pos="bottom")
waffle(andel_utgifter, colors=qualitative_hcl(10,"Dark 3"), xlab="1 rute = 1 prosent", title= "Fylkeskommunale utgifter etter område", legend_pos="right")
?filter
?grep
temp <- filter(df, !grepl("fylkeskommune",region))
View(temp)
temp <- filter(df, grepl("fylkeskommune",region))
View(temp)
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"))%>%
group_by(funksjon_summert)%>%
summarise(andel = sum(value))
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"))%>%
group_by(region,funksjon_summert)%>%
summarise(andel = sum(value))
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"))%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
mutate(.,funksjon_summert = factor(levels=c("Videregående opplæring samlet","Samferdsel, fylkeskommune","Andre")))
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"))%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
mutate(.,funksjon_summert = factor(funksjon_summert,levels=c("Videregående opplæring samlet","Samferdsel, fylkeskommune","Andre")))
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Videregående opplæring samlet","Samferdsel, fylkeskommune","Andre"))
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
View(temp)
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill")
?geom_col
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet"))
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill")
?scale_x_discrete
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
??str_replace
library(stringr)
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune",""))
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune",replacement=""))
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune",replacement=" "))
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
temp <- filter(df, grepl("fylkeskommune",region))%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
#pakker
library(tidyverse)
library(colorspace)
library(waffle)
library(PxWebApiData)
library(stringr)
alle_data = ApiData("https://data.ssb.no/api/v0/no/table/12163",
KOKfylkesregion0000 = TRUE,
KOKfunksjon0000 = c("FGF1a", "FGF1b", "FGF1c", "FGF2", "FGF3", "FGF4", "FGF5", "FGF6a", "FGF7", "FGF8"),
KOKart0000 = "AGD10",
ContentsCode = "KOSandel3501",
Tid = "2018"
)
df <- alle_data[[1]] %>%
select(.,-art,-statistikkvariabel,-`år`)
blogdown:::serve_site()
temp <- filter(df,region=="Landet uten Oslo")%>%
mutate(funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"))%>%
group_by(funksjon_summert)%>%
summarise(andel = sum(value))
ggplot(data = temp, aes(x = 1, y = andel, fill = funksjon_summert)) +
geom_col()+
coord_polar(theta="y")+
theme_void()+
ggtitle("Fylkeskommunal pengebruk etter område", subtitle = "Alle unntatt Oslo")+
scale_fill_discrete(name="Funksjon")
#litt databearbeiding først - filtrering, sortering og avrunding
temp <- filter(df,region=="Landet uten Oslo")%>%
arrange(.,desc(value))%>%
mutate(.,andel = round(value,0))
#waffle() tar en "named vector"
andel_utgifter = temp$andel
names(andel_utgifter) = temp$funksjon
#så selve plottinga
waffle(andel_utgifter,
colors=qualitative_hcl(10,"Cold"),
xlab="1 rute = 1 prosent",
title= "Fylkeskommunale utgifter etter område",
legend_pos="right")
waffle(andel_utgifter,
colors=qualitative_hcl(10,"Dark 3"),
xlab="1 rute = 1 prosent",
title= "Fylkeskommunale utgifter etter område",
legend_pos="right")
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
?fct_reorder
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))
View(temp)
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
mutate(.,region = fct_reorder(region,as.numeric(funksjon_summert),fun=mean))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder(region,as.numeric(funksjon_summert),fun=mean))
View(temp)
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,as.numeric(funksjon_summert),andel,fun=mean))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,as.numeric(funksjon_summert),andel))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,andel,as.numeric(funksjon_summert)))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,andel,as.numeric(funksjon_summert)))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,as.numeric(funksjon_summert),andel))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,as.numeric(funksjon_summert),andel))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 0))
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,as.numeric(funksjon_summert),andel))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
?theme_set
theme_set(theme_minimal())
#litt databearbeiding først
#her er vi interessert i alle fylkeskommunene og gjennomsnittet for landet uten Oslo,
#vi vil også ha maks tre kategorier,
#og sortert slik (via factor-levels) at videregående kommer nederst
#regionene skal være sortert etter størrelsen på budsjettet til vgs
#litt usikker på hvordan fct_reorder2 får til det, men det virker
temp <- filter(df, grepl("fylkeskommune",region)|region=="Landet uten Oslo")%>%
mutate(.,
funksjon_summert = ifelse(funksjon %in% c("Videregående opplæring samlet","Samferdsel, fylkeskommune"), funksjon, "Andre"),
funksjon_summert = factor(funksjon_summert,levels=c("Andre","Samferdsel, fylkeskommune","Videregående opplæring samlet")),
region = str_replace(region,fixed("fylkeskommune"),replacement=" ")
)%>%
group_by(.,region,funksjon_summert)%>%
summarise(.,andel = sum(value))%>%
ungroup()%>%
mutate(.,region = fct_reorder2(region,as.numeric(funksjon_summert),andel))
ggplot(data=temp)+
geom_col(aes(x=region,y=andel,fill=funksjon_summert),position="fill") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
library(httr)
library(jsonlite)
library(dplyr)
library(knitr)
library(here)
?here
source(here("content/scripts/imdi_api_function.R"))
url = "https://imdifakta.azurewebsites.net/api/v1/metadata/tables"
test_tabeller = GET(url)
df = data.frame(datasett = fromJSON(content(test_tabeller,"text",encoding="UTF-8")))
kable(df)
View(df)
url = "https://imdifakta.azurewebsites.net/api/v1/metadata/headers/befolkning_alder"
test_tabeller = GET(url)
df = fromJSON(content(test_tabeller,"text",encoding="UTF-8"))
kable(df$headers)
View(df)
df$headers
url = "https://imdifakta.azurewebsites.net/api/v1/metadata/headergroups/befolkning_alder"
test_tabeller = GET(url)
df = fromJSON(content(test_tabeller,"text",encoding="UTF-8"))
str(df)
#henter data fra query-api
url = "https://imdifakta.azurewebsites.net/api/v1/data/query"
data =
'{"TableName":"befolkning_hovedgruppe",
"Include":
["innvkat5","kjonn","fylkeNr","enhet","aar"],
"Conditions":
{"innvkat5":["innvandrere","bef_u_innv_og_norskf","norskfodte_m_innvf"],
"kjonn":["alle"],
"fylkeNr":["00"],
"enhet":["personer"]
}
}'
#ma ha med content_type_json() for a fa 200 ok
test = POST(url,body=data,encode="json",verbose(),content_type_json())
df = fromJSON(content(test,"text",encoding="UTF-8"))[[1]]
head(df)
imdi_fetch_example = function(data){
temp_queryresult = POST("https://imdifakta.azurewebsites.net/api/v1/data/query",body=data,encode="json",verbose(),content_type_json())
temp_df = fromJSON(content(temp_queryresult,"text",encoding="UTF-8"))
if(length(temp_df)==1){
return(temp_df[[1]])
}
if(length(temp_df)>1){
temp_df_final = data.frame()
temp_df_final = bind_rows(temp_df_final,temp_df[[2]])
i = 0
}
#bruker en while-loop, og det er vel fy?
while(length(temp_df)>1){
i = i+1
temp_token = temp_df$continuation
temp_token_format = paste0('{','"continuation":"',temp_token,'",')
new_data = substring(data,2,nchar(data)+1)
new_data_query =paste0(temp_token_format,new_data)
temp_queryresult = POST("https://imdifakta.azurewebsites.net/api/v1/data/query",body=new_data_query,encode="json",verbose(),content_type_json())
temp_df = fromJSON(content(temp_queryresult,"text",encoding="UTF-8"))
if(length(temp_df)>1){
temp_df_final = bind_rows(temp_df_final,temp_df[[2]])
Sys.sleep(5) #høfflig å ikke spørre for mange ganger på kort tid, derfor sleep 5 sek.
}
if(length(temp_df)==1){
temp_df_final = bind_rows(temp_df_final,temp_df[[1]])
print(paste0("Fullført på ",i," repetisjoner"))
}
}
return(temp_df_final)
}
url = "https://imdifakta.azurewebsites.net/api/v1/data/compare"
data =
'{"TableName":"befolkning_hovedgruppe",
"Conditions":
{"innvkat5":["innvandrere","bef_u_innv_og_norskf","norskfodte_m_innvf"],
"kjonn":["alle"],
"enhet":["personer"]
},
"Compare": {
"kommuneNr": ["0101"],
"fylkeNr": ["00"]
}
}'
#ma ha med content_type_json() for a fa 200 ok
test = POST(url,body=data,encode="json",verbose(),content_type_json())
df = fromJSON(content(test,"text",encoding="UTF-8"))[[1]]
head(df)
test = imdi_fetch_table()
View(test)
df = filter(test,enhet=="personer")%>%
mutate(.,tall = as.numeric(tabellvariabel))%>%
group_by(.,aar,bosetting)%>%
summarise(.,antall = sum(tall,na.rm=TRUE))
View(df)
df = filter(test,enhet=="personer")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))%>%
group_by(.,aar,bosetting)%>%
summarise(.,antall = sum(tall,na.rm=TRUE))
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
library(ggplot2)
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
df = filter(test,enhet=="personer")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))%>%
group_by(.,aar,bosetting)%>%
summarise(.,antall = sum(tall,na.rm=FALSE))
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
df = filter(test,enhet=="personer")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))%>%
group_by(.,aar,bosetting)%>%
summarise(.,antall = sum(tall,na.rm=TRUE))
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
levels(as.factor(test$kommuneNr))
df = filter(test,enhet=="personer",kommuneNr!="0000")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))%>%
group_by(.,aar,bosetting)%>%
summarise(.,antall = sum(tall,na.rm=TRUE))
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
theme_set(theme_minimal())
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
?na_if
df = filter(test,enhet=="personer",kommuneNr!="0000")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))%>%
group_by(.,aar,bosetting)%>%
summarise(.,antall = sum(tall,na.rm=TRUE))%>%
mutate(.,antall = na_if(antall,0))
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
df = filter(test,enhet == "personer", bosetting == "vedtak")
df = filter(test,enhet == "personer", bosetting == "vedtak")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=1)+
geom_boxplot(alpha=1)
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=1)+
geom_boxplot(alpha=1)+
coord_flip()
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=0.3)+
geom_boxplot(alpha=1)+
coord_flip()
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=0.3)+
geom_boxplot(alpha=0)+
coord_flip()
df = filter(test,enhet=="personer",kommuneNr!="0000")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))%>%
group_by(.,aar,bosetting)%>%
summarise(.,antall = sum(tall,na.rm=TRUE))%>%
mutate(.,antall = na_if(antall,0))
ggplot(data=df)+
geom_line(aes(x=aar,y=antall,colour=bosetting))
df = filter(test,enhet == "personer", bosetting == "vedtak")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=0.3)+
geom_boxplot(alpha=0)+
coord_flip()
df = filter(test,enhet == "personer", bosetting == "vedtak")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=0.3)+
geom_boxplot(alpha=0)+
coord_flip()
df = filter(test,enhet == "personer", bosetting == "vedtak")%>%
mutate(.,tall = as.numeric(tabellvariabel),aar=as.numeric(aar))
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=0.3)+
geom_boxplot(alpha=0)+
coord_flip()
theme_set(theme_minimal())
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=0.3)+
geom_boxplot(alpha=0)+
coord_flip()
ggplot(data = df, aes(x= kommuneNr, y = tall))+
geom_jitter(colour = "steelblue", alpha=0.3)+
geom_boxplot(alpha=0)+
coord_flip()
